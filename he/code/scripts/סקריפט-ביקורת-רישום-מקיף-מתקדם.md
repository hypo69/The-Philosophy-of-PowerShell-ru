### סקריפט ביקורת רישום מקיף מתקדם

סקריפט זה הוא רב-תכליתי יותר ומאפשר ביצוע ביקורת מפורטת יותר. הוא עדיין דורש הרשאות מנהל מערכת כדי לגשת למפתחות מסוימים.

**דוגמה לסקריפט שנוצר:**

```powershell
Write-Host "--- ביקורת רישום Windows מתקדמת ומקיפה ---" -ForegroundColor Green
Write-Host "הסקריפט מבצע בדיקה מקיפה של המערכת, האבטחה והרשת." -ForegroundColor Cyan

# 1. בדיקת תוכניות הפעלה אוטומטית
Write-Host "`n[1] בדיקת תוכניות הפעלה אוטומטית" -ForegroundColor Yellow
$autoRunPaths = @(
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run",
    "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run",
    "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run"
)
foreach ($path in $autoRunPaths) {
    if (Test-Path -Path $path) {
        Write-Host "  - בדיקת מפתח: $path" -ForegroundColor Cyan
        Get-ItemProperty -Path $path -ErrorAction SilentlyContinue | ForEach-Object {
            $name = $_.PSChildName
            $value = $_.$name
            if ($value) {
                Write-Host "    - שם: $name" -ForegroundColor Magenta
                Write-Host "      נתיב:   $value" -ForegroundColor Magenta
            }
        }
    }
}

---

# 2. בדיקת הגדרות אבטחה
Write-Host "`n[2] בדיקת הגדרות אבטחה" -ForegroundColor Yellow

# בדיקת UAC
$uacStatus = (Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System").EnableLUA
if ($uacStatus -eq 1) {
    Write-Host "  - UAC (בקרת חשבון משתמש): מופעל" -ForegroundColor Green
} else {
    Write-Host "  - UAC (בקרת חשבון משתמש): מושבת" -ForegroundColor Red
}

# בדיקת מצב Windows Defender (מצב אמיתי, לא רק רישום)
Write-Host "  - Windows Defender:" -ForegroundColor Cyan
try {
    $defenderStatus = Get-MpComputerStatus
    $defenderRealtime = $defenderStatus.RealTimeProtectionEnabled
    if ($defenderRealtime) {
        Write-Host "    - הגנה בזמן אמת: מופעלת" -ForegroundColor Green
    } else {
        Write-Host "    - הגנה בזמן אמת: מושבתת" -ForegroundColor Red
    }
} catch {
    Write-Host "    - לא ניתן לקבל את מצב Windows Defender. ייתכן שנעשה שימוש באנטי-וירוס צד שלישי." -ForegroundColor Yellow
}

---

# 3. מידע מערכת ונתיבי תיקיות
Write-Host "`n[3] מידע מערכת ונתיבי תיקיות מערכת" -ForegroundColor Yellow
$osInfo = Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion"
Write-Host "  - גרסת מערכת הפעלה: $($osInfo.ProductName) $($osInfo.CurrentVersion)" -ForegroundColor Cyan
Write-Host "  - בניית מערכת הפעלה: $($osInfo.BuildLabEx)" -ForegroundColor Cyan

$shellFolders = Get-ItemProperty "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders"
Write-Host "  - נתיב שולחן העבודה: $($shellFolders.Desktop)" -ForegroundColor Cyan
Write-Host "  - נתיב מסמכים: $($shellFolders.Personal)" -ForegroundColor Cyan

---

# 4. ביקורת הגדרות רשת
Write-Host "`n[4] ביקורת הגדרות רשת" -ForegroundColor Yellow

# בדיקת הגדרות מטמון DNS
$dnsCache = Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Services\Dnscache\Parameters" -ErrorAction SilentlyContinue
if ($dnsCache) {
    Write-Host "  - זמן חיים מקסימלי של תגובת DNS חיובית: $($dnsCache.MaxCacheEntryTtlLimit) שניות" -ForegroundColor Cyan
    Write-Host "  - זמן חיים מקסימלי של תגובת DNS שלילית: $($dnsCache.MaxNegativeCacheTtl) שניות" -ForegroundColor Cyan
} else {
    Write-Host "  - לא ניתן לקבל את הגדרות מטמון DNS." -ForegroundColor Red
}

# בדיקת הגדרות חומת אש
try {
    $firewallProfiles = Get-NetFirewallProfile
    Write-Host "  - מצב חומת אש:" -ForegroundColor Cyan
    $firewallProfiles | Format-Table -AutoSize
} catch {
    Write-Host "  - לא ניתן לקבל את מצב חומת האש. הפעל את הסקריפט עם הרשאות מנהל מערכת." -ForegroundColor Red
}

# בדיקת DHCP עבור מתאמי רשת
Write-Host "  - מצב DHCP עבור מתאמי רשת:" -ForegroundColor Cyan
Get-NetAdapter | ForEach-Object {
    $adapter = $_
    $ip = Get-NetIPConfiguration -InterfaceIndex $adapter.InterfaceIndex -ErrorAction SilentlyContinue
    if ($ip) {
        Write-Host "    - $($adapter.Name): $($ip.DhcpEnabled)" -ForegroundColor Cyan
    }
}

---

# 5. ביקורת היסטוריית חיבורי התקני USB
Write-Host "`n[5] היסטוריית חיבורי התקני USB" -ForegroundColor Yellow
Write-Host "  (דורש הרשאות מנהל מערכת)" -ForegroundColor Red
try {
    $usbDevices = Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Enum\USBSTOR\*"
    if ($usbDevices.Count -gt 0) {
        $usbDevices | ForEach-Object {
            Write-Host "  - התקן: $($_.PSChildName)" -ForegroundColor Magenta
            Write-Host "    תיאור: $($_.FriendlyName)" -ForegroundColor Magenta
        }
    } else {
        Write-Host "  - התקני USB לא נמצאו ברישום." -ForegroundColor Green
    }
} catch {
    Write-Host "  - שגיאה: לא ניתן לגשת למפתח התקן USB. הפעל את הסקריפט עם הרשאות מנהל מערכת." -ForegroundColor Red
}

Write-Host "`n--- ביקורת הושלמה ---" -ForegroundColor Green

כפי שאתה יכול לראות, עם PowerShell, אתה יכול לקבל תמונה מפורטת מאוד של מצב המערכת פשוט על ידי הסתכלות במקומות הנכונים ברישום ושימוש בפקודות המתאימות. אם יש לך רעיונות נוספים לבדיקות, הודע לי!

```