# Filozofia PowerShell.
## CzÄ™Å›Ä‡ 0.
Co byÅ‚o przed PowerShell?
W 1981 roku ukazaÅ‚ siÄ™ MS-DOS 1.0 z interpreterem poleceÅ„ `COMMAND.COM`. Do automatyzacji zadaÅ„ uÅ¼ywano **plikÃ³w wsadowych (`.bat`)** â€” prostych plikÃ³w tekstowych z sekwencjÄ… poleceÅ„ konsoli. ZaskakujÄ…cy ascetyzm wiersza poleceÅ„ na tle systemÃ³w zgodnych z POSIX, gdzie juÅ¼ od 1979 roku istniaÅ‚a **powÅ‚oka Bourne'a (`sh`)**.



### ğŸ“… Stan rynku powÅ‚ok w momencie wydania **MS-DOS 1.0** (sierpieÅ„ 1981)

PoniÅ¼ej znajduje siÄ™ tabela podsumowujÄ…ca popularne systemy operacyjne tamtych czasÃ³w i ich obsÅ‚ugÄ™ powÅ‚ok (`sh`, `csh` itp.):

| System operacyjny            | ObsÅ‚uga powÅ‚ok (`sh`, `csh`, itp.) | Komentarz                                                  |
| ---------------------------- | ---------------------------------- | ------------------------------------------------------------ |
| **UNIX Version 7 (V7)**      | `sh`                               | Ostatni klasyczny UNIX Bell Labs, szeroko rozpowszechniony   |
| **UNIX/32V**                 | `sh`, `csh`                        | Wersja UNIX dla architektury VAX                             |
| **4BSD / 3BSD**              | `sh`, `csh`                        | Uniwersytecka gaÅ‚Ä…Åº UNIX z Berkeley                          |
| **UNIX System III**          | `sh`                               | Pierwsza komercyjna wersja od AT&T, poprzednik System V      |
| **Xenix (od Microsoft)**     | `sh`                               | Licencjonowana wersja UNIX, sprzedawana przez Microsoft od 1980 |
| **IDRIS**                    | `sh`                               | System operacyjny podobny do UNIX dla PDP-11 i Intel        |
| **Coherent (Mark Williams)** | `sh` (podobna)                     | Niedroga alternatywa UNIX dla komputerÃ³w PC                  |
| **CP/M (Digital Research)**  | âŒ (Brak `sh`, tylko najprostszy CLI) | Nie UNIX, najpopularniejszy system operacyjny dla 8-bitowych PC |
| **MS-DOS 1.0**               | âŒ (tylko `COMMAND.COM`)            | Minimalna powÅ‚oka poleceÅ„, brak skryptÃ³w lub potokÃ³w         |

---

### ğŸ’¡ Co to jest `sh`, `csh`

* `sh` â€” **Bourne Shell**, gÅ‚Ã³wny interpreter skryptÃ³w UNIX od 1977 roku.
* `csh` â€” **C Shell**, ulepszona powÅ‚oka z skÅ‚adniÄ… podobnÄ… do C i udogodnieniami do pracy interaktywnej.
* Te powÅ‚oki **obsÅ‚ugiwaÅ‚y przekierowania, potoki, zmienne, funkcje i warunki** â€” wszystko, co uczyniÅ‚o UNIX potÄ™Å¼nym narzÄ™dziem automatyzacji.

---

Microsoft skupiÅ‚a siÄ™ na **tanich 16-bitowych komputerach IBM PC**, ktÃ³re miaÅ‚y **maÅ‚o pamiÄ™ci** (zazwyczaj 64â€“256 KB), nie miaÅ‚y wielozadaniowoÅ›ci i byÅ‚y przeznaczone do **uÅ¼ytku domowego i biurowego**, a nie serwerÃ³w. UNIX byÅ‚ drogi, wymagaÅ‚ zÅ‚oÅ¼onej architektury i doÅ›wiadczenia, podczas gdy ksiÄ™gowi i inÅ¼ynierowie, a nie administratorzy systemÃ³w, potrzebowali szybkiego i prostego systemu operacyjnego.

Interfejs DOS, zamiast zÅ‚oÅ¼onego `sh`, przedstawiaÅ‚ jeden plik command.com z ubogim zestawem wewnÄ™trznych poleceÅ„ [ (dir, copy, del itp.)](https://www.techgeekbuzz.com/blog/dos-commands/){:target="_blank"} bez funkcji, pÄ™tli czy moduÅ‚Ã³w.

ByÅ‚y teÅ¼ polecenia zewnÄ™trzne â€” oddzielne pliki wykonywalne (.exe lub .com). PrzykÅ‚ady: FORMAT.COM, XCOPY.EXE, CHKDSK.EXE, EDIT.COM.
Skrypty wykonywalne zapisywano w pliku tekstowym z rozszerzeniem .bat (plik wsadowy).

PrzykÅ‚ady plikÃ³w konfiguracyjnych:

- AUTOEXEC.BAT

```bash
:: ------------------------------------------------------------------------------
:: AUTOEXEC.BAT â€” Automatyczna konfiguracja i uruchamianie Windows 3.11
:: Autor: hypo69
:: Rok: okoÅ‚o 1993
:: Przeznaczenie: Wykonuje inicjalizacjÄ™ Å›rodowiska DOS, Å‚aduje sterowniki sieciowe i uruchamia Windows 3.11
:: ------------------------------------------------------------------------------
@ECHO OFF

:: Ustawienie wiersza poleceÅ„
PROMPT $p$g

:: Ustawienie zmiennych Å›rodowiskowych
SET TEMP=C:\TEMP
PATH=C:\DOS;C:\WINDOWS

:: Åadowanie sterownikÃ³w i narzÄ™dzi do pamiÄ™ci gÃ³rnej
LH C:\DOS\SMARTDRV.EXE       :: PamiÄ™Ä‡ podrÄ™czna dysku
LH C:\DOS\MOUSE.COM          :: Sterownik myszy

:: Åadowanie usÅ‚ug sieciowych (istotne dla Windows for Workgroups 3.11)
IF EXIST C:\NET\NET.EXE LH C:\NET\NET START

:: Automatyczne uruchamianie Windows
WIN

```
- CONFIG.SYS
```bash
:: ------------------------------------------------------------------------------
:: CONFIG.SYS â€” Konfiguracja pamiÄ™ci i sterownikÃ³w DOS dla Windows 3.11
:: Autor: hypo69
:: Rok: okoÅ‚o 1993
:: Przeznaczenie: Inicjalizacja sterownikÃ³w pamiÄ™ci, konfiguracja parametrÃ³w systemowych
:: ------------------------------------------------------------------------------
DEVICE=C:\DOS\HIMEM.SYS
DEVICE=C:\DOS\EMM386.EXE NOEMS
DOS=HIGH,UMB
FILES=40
BUFFERS=30
DEVICEHIGH=C:\DOS\SETVER.EXE

```

W Microsoft, rÃ³wnolegle do DOS, niemal natychmiast rozpoczÄ™to rozwÃ³j zasadniczo nowego jÄ…dra.

JÄ…dro [**Windows NT**](https://www.wikiwand.com/ru/articles/Windows_NT){:target="_blank"} (New Technology) pojawiÅ‚o siÄ™ po raz pierwszy wraz z wydaniem systemu operacyjnego:

> **Windows NT 3.1 â€” 27 lipca 1993 roku**

---

* **RozwÃ³j rozpoczÄ…Å‚ siÄ™**: w **1988 roku** pod kierownictwem **Dave'a Cutlera** (byÅ‚ego inÅ¼yniera DEC, twÃ³rcy VMS) w celu stworzenia caÅ‚kowicie nowego, bezpiecznego, przenoÅ›nego i wielozadaniowego systemu operacyjnego, niekompatybilnego z MS-DOS na poziomie jÄ…dra.
* **NT 3.1** â€” nazwana tak, aby podkreÅ›liÄ‡ kompatybilnoÅ›Ä‡ z **Windows 3.1** na poziomie interfejsu, ale miaÅ‚a **zupeÅ‚nie nowÄ… architekturÄ™**.

---

#### ğŸ§  Co przyniosÅ‚o jÄ…dro NT:

| Cecha                        | Opis                                                              |
| ---------------------------- | --------------------------------------------------------------------- |
| **Architektura 32-bitowa**   | W przeciwieÅ„stwie do MS-DOS i Windows 3.x, ktÃ³re byÅ‚y 16-bitowe.      |
| **WielozadaniowoÅ›Ä‡**         | Prawdziwa wielozadaniowoÅ›Ä‡ wywÅ‚aszczajÄ…ca.                            |
| **PamiÄ™Ä‡ chroniona**         | Programy nie mogÅ‚y uszkodziÄ‡ pamiÄ™ci innych.                          |
| **ModuÅ‚owoÅ›Ä‡**               | Wielowarstwowa architektura jÄ…dra: HAL, Executive, Kernel, sterowniki. |
| **ObsÅ‚uga wielu platform**   | NT 3.1 dziaÅ‚aÅ‚ na x86, MIPS i Alpha.                                  |
| **ZgodnoÅ›Ä‡ z POSIX**         | NT dostarczany byÅ‚ z **podsystemem POSIX**, certyfikowanym zgodnie z POSIX.1. |

---

#### ğŸ“œ Linia produktÃ³w NT:

| Wersja NT     | Rok       | Komentarz                          |
| ------------- | --------- | ---------------------------------- |
| NT 3.1        | 1993      | Pierwsze wydanie NT               |
| NT 3.5 / 3.51 | 1994â€“1995 | Ulepszenia, optymalizacja          |
| NT 4.0        | 1996      | Interfejs Windows 95, ale jÄ…dro NT |
| Windows 2000  | 2000      | NT 5.0                             |
| Windows XP    | 2001      | NT 5.1                             |
| Windows Vista | 2007      | NT 6.0                             |
| Windows 10    | 2015      | NT 10.0                            |
| Windows 11    | 2021      | RÃ³wnieÅ¼ NT 10.0 (marketing ğŸ˜Š)      |

---

RÃ³Å¼nice w moÅ¼liwoÅ›ciach systemÃ³w operacyjnych:

| Charakterystyka                 | **MS-DOS** (1981)                       | **Windows NT** (1993)                               |
| ------------------------------- | --------------------------------------- | --------------------------------------------------- |
| **Typ systemu**                 | Monolityczny, jednowÄ…tkowy              | MikrojÄ…drowy/hybrydowy, wielozadaniowy              |
| **Bity**                        | 16-bitowy                               | 32-bitowy (z obsÅ‚ugÄ… 64-bitowÄ… od NT 5.2 / XP x64)  |
| **WielozadaniowoÅ›Ä‡**            | âŒ Brak (jeden proces na raz)           | âœ… WielozadaniowoÅ›Ä‡ wywÅ‚aszczajÄ…ca                  |
| **PamiÄ™Ä‡ chroniona**            | âŒ Brak                                 | âœ… Tak (kaÅ¼dy proces we wÅ‚asnej przestrzeni adresowej) |
| **Tryb wielouÅ¼ytkownikowy**     | âŒ Brak                                 | âœ… CzÄ™Å›ciowo (w NT Workstation/Server)              |
| **ZgodnoÅ›Ä‡ z POSIX**            | âŒ Brak                                 | âœ… Wbudowany podsystem POSIX w NT 3.1â€“5.2           |
| **PrzenoÅ›noÅ›Ä‡ jÄ…dra**           | âŒ Tylko x86                            | âœ… x86, MIPS, Alpha, PowerPC                        |
| **Sterowniki**                  | BezpoÅ›redni dostÄ™p do sprzÄ™tu           | Poprzez HAL i sterowniki trybu jÄ…dra                |
| **Poziom dostÄ™pu aplikacji**    | Aplikacje = poziom systemowy            | Poziom uÅ¼ytkownika / jÄ…dra rozdzielone              |
| **BezpieczeÅ„stwo**              | âŒ Brak                                 | âœ… Model bezpieczeÅ„stwa: SID, ACL, tokeny dostÄ™pu    |
| **StabilnoÅ›Ä‡**                  | âŒ ZaleÅ¼noÅ›Ä‡ jednego programu = awaria OS | âœ… Izolacja procesÃ³w, ochrona jÄ…dra                 |

---

Ale byÅ‚o jedno duÅ¼e ALE! NarzÄ™dziom do automatyzacji i administracji nie poÅ›wiÄ™cano naleÅ¼ytej uwagi aÅ¼ do 2002 roku.

---

Microsoft stosowaÅ‚a zupeÅ‚nie inne podejÅ›cia, strategie i narzÄ™dzia do administracji. Wszystko to byÅ‚o **rozproszone**, czÄ™sto zorientowane na GUI i nie zawsze moÅ¼liwe do zautomatyzowania.

---

##### ğŸ“Œ Lista niektÃ³rych narzÄ™dzi:

| NarzÄ™dzie                     | Przeznaczenie                                                   |
| ----------------------------- | --------------------------------------------------------------- |
| `cmd.exe`                     | Ulepszony interpreter poleceÅ„ (zamiennik `COMMAND.COM`)         |
| `.bat`, `.cmd`                | Skrypty wiersza poleceÅ„                                         |
| **Windows Script Host (WSH)** | ObsÅ‚uga VBScript i JScript do automatyzacji                     |
| `reg.exe`                     | ZarzÄ…dzanie rejestrem z wiersza poleceÅ„                         |
| `net.exe`                     | Praca z uÅ¼ytkownikami, sieciÄ…, drukarkami                       |
| `sc.exe`                      | ZarzÄ…dzanie usÅ‚ugami                                            |
| `tasklist`, `taskkill`        | ZarzÄ…dzanie procesami                                           |
| `gpedit.msc`                  | Zasady grupy (lokalnie)                                         |
| `MMC`                         | Konsola z przystawkami do zarzÄ…dzania                           |
| `WMI`                         | DostÄ™p do informacji systemowych (przez `wmic`, VBScript lub COM) |
| `WbemTest.exe`                | GUI do testowania zapytaÅ„ WMI                                   |
| `eventvwr`                    | PrzeglÄ…darka dziennikÃ³w zdarzeÅ„                                 |
| `perfmon`                     | Monitorowanie zasobÃ³w                                           |

##### ğŸ›  PrzykÅ‚ady automatyzacji:

* Pliki VBScript (`*.vbs`) do administrowania uÅ¼ytkownikami, sieciami, drukarkami i usÅ‚ugami.
* `WMIC` â€” interfejs wiersza poleceÅ„ do WMI (np.: `wmic process list brief`).
* Skrypty `.cmd` z wywoÅ‚aniami `net`, `sc`, `reg`, `wmic` itp.

---

### âš™ï¸ Windows Scripting Host (WSH)

* Po raz pierwszy pojawiÅ‚ siÄ™ w **Windows 98**, aktywnie uÅ¼ywany w **Windows 2000 i XP**.
* UmoÅ¼liwiaÅ‚ wykonywanie plikÃ³w VBScript i JScript z wiersza poleceÅ„:

  ```vbscript
  Set objShell = WScript.CreateObject("WScript.Shell")
  objShell.Run "notepad.exe"
  ```

---
## CzÄ™Å›Ä‡ 1.

Dopiero w 2002 roku firma sformuÅ‚owaÅ‚a projekt <a href="https://learn.microsoft.com/en-us/powershell/scripting/developer/monad-manifesto?view=powershell-7.5" target="_blank">Monad</a>, ktÃ³ry pÃ³Åºniej przeksztaÅ‚ciÅ‚ siÄ™ w PowerShell:

PoczÄ…tek rozwoju: okoÅ‚o 2002 roku

Publiczne ogÅ‚oszenie: 2003 rok, jako "Monad Shell"

Pierwsze wersje beta: pojawiÅ‚y siÄ™ do 2005 roku

Ostateczne wydanie (PowerShell 1.0): listopad 2006 roku

Autorem i gÅ‚Ã³wnym architektem projektu Monad / PowerShell jest Jeffrey Snover
<a href="https://www.wikiwand.com/en/articles/Jeffrey_Snover" target="_blank"> (Jeffrey Snover)</a>

DziÅ› PowerShell Core dziaÅ‚a na
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/windows-core.md" target="_blank">Windows</a>
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/macos.md" target="_blank">macOS</a>
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/linux.md" target="_blank">Linux</a>

RÃ³wnolegle rozwijano framework .NET, a PowerShell zostaÅ‚ w niego gÅ‚Ä™boko zintegrowany; w kolejnych rozdziaÅ‚ach pokaÅ¼Ä™ przykÅ‚ady.

A teraz â€” najwaÅ¼niejsze!

GÅ‚Ã³wnÄ… zaletÄ… PowerShell w porÃ³wnaniu z klasycznymi powÅ‚okami poleceÅ„ jest to, Å¼e pracuje on z *obiektami*, a nie z tekstem. Kiedy wykonujesz polecenie, zwraca ono nie tylko tekst, ale ustrukturyzowany obiekt (lub kolekcjÄ™ obiektÃ³w), ktÃ³ry ma jasno zdefiniowane wÅ‚aÅ›ciwoÅ›ci (Properties) i metody (Methods).

Zobacz, jak PowerShell przewyÅ¼sza klasyczne powÅ‚oki dziÄ™ki **pracy z obiektami**.

### ğŸ“ Jak to byÅ‚o: `dir` i rÄ™czne parsowanie

W **CMD** (zarÃ³wno w starym `COMMAND.COM`, jak i w `cmd.exe`) polecenie `dir` zwraca wynik jako zwykÅ‚y tekst. PrzykÅ‚ad wyjÅ›cia:

```
24.07.2025  21:15         1 428  my_script.js
25.07.2025  08:01         3 980  report.html
```

ZaÅ‚Ã³Å¼my, Å¼e chcesz wyodrÄ™bniÄ‡ **nazwÄ™ pliku** i **rozmiar** kaÅ¼dego pliku. BÄ™dziesz musiaÅ‚ rÄ™cznie parsowaÄ‡ wiersze:
```cmd
for /f "tokens=5,6" %a in ('dir ^| findstr /R "[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]"') do @echo %a %b
```

* Jest to strasznie trudne do odczytania, zaleÅ¼y od ustawieÅ„ regionalnych, formatu daty, czcionki. I psuje siÄ™ przy spacjach w nazwach.

---

### âœ… PowerShell: obiekty zamiast tekstu

#### âœ” Prosty i czytelny przykÅ‚ad:

```powershell
Get-ChildItem | Select-Object Name, Length
```

**Wynik:**

```
Name          Length
----          ------
my_script.js   1428
report.html    3980
```

* `Get-ChildItem` zwraca **tablicÄ™ obiektÃ³w plikÃ³w/folderÃ³w**
* `Select-Object` pozwala Å‚atwo uzyskaÄ‡ potrzebne **wÅ‚aÅ›ciwoÅ›ci**

---

### ğŸ” Co tak naprawdÄ™ zwraca `Get-ChildItem`?

```powershell
$item = Get-ChildItem -Path .\my_script.js
$item | Get-Member
```

**Wynik:**

```
TypeName: System.IO.FileInfo

Name         MemberType     Definition
----         ---------      ----------
Length       Property       long Length {get;}
Name         Property       string Name {get;}
CreationTime Property       datetime CreationTime {get;set;}
Delete       Method         void Delete()
...
```

PowerShell zwraca **obiekty typu `System.IO.FileInfo`**, ktÃ³re majÄ…:

* ğŸ§± WÅ‚aÅ›ciwoÅ›ci (`Name`, `Length`, `CreationTime`, `Extension`, â€¦)
* ğŸ›  Metody (`Delete()`, `CopyTo()`, `MoveTo()` itp.)

Pracujesz **z peÅ‚noprawnymi obiektami**, a nie z ciÄ…gami znakÃ³w.

---

### SkÅ‚adnia "Czasownik-Rzeczownik":

PowerShell uÅ¼ywa **Å›cisÅ‚ej i logicznej skÅ‚adni poleceÅ„**:
`Czasownik-Rzeczownik` (Verb-Noun)

| Czasownik | Co robi    |
| --------- | ---------- |
| `Get-`    | Pobierz    |
| `Set-`    | Ustaw      |
| `New-`    | UtwÃ³rz     |
| `Remove-` | UsuÅ„       |
| `Start-`  | Uruchom    |
| `Stop-`   | Zatrzymaj  |

| Rzeczownik    | Nad czym pracuje |
| ------------- | ---------------- |
| `Process`     | Proces           |
| `Service`     | UsÅ‚uga           |
| `Item`        | Plik/folder      |
| `EventLog`    | Dzienniki zdarzeÅ„ |
| `Computer`    | Komputer         |

#### ğŸ”„ PrzykÅ‚ady:

| Co naleÅ¼y zrobiÄ‡         | Polecenie         |
| ------------------------ | ----------------- |
| Pobierz procesy          | `Get-Process`     |
| Zatrzymaj usÅ‚ugÄ™         | `Stop-Service`    |
| UtwÃ³rz nowy plik         | `New-Item`        |
| Pobierz zawartoÅ›Ä‡ folderu | `Get-ChildItem`   |
| UsuÅ„ plik                | `Remove-Item`     |

â¡ Nawet jeÅ›li **nie znasz dokÅ‚adnego polecenia**, moÅ¼esz je **odgadnÄ…Ä‡** na podstawie jego znaczenia â€” i prawie zawsze trafisz.


---

Cmdlet `Get-Help` to TwÃ³j gÅ‚Ã³wny pomocnik.


1.  **Uzyskaj pomoc na temat samej pomocy:**
    ```powershell
    Get-Help Get-Help
    ```
2.  **Uzyskaj podstawowÄ… pomoc na temat polecenia do pracy z procesami:**
    ```powershell
    Get-Help Get-Process
    ```
3.  **Zobacz przykÅ‚ady uÅ¼ycia tego polecenia:**
    ```powershell
    Get-Help Get-Process -Examples
    ```
    Jest to niezwykle przydatny parametr, ktÃ³ry czÄ™sto dostarcza gotowe rozwiÄ…zania dla Twoich zadaÅ„.
4.  **Uzyskaj najbardziej szczegÃ³Å‚owe informacje o poleceniu:**
    ```powershell
    Get-Help Get-Process -Full
    ```
W nastÄ™pnej czÄ™Å›ci: potok lub Å‚aÅ„cuch poleceÅ„ (PipeLines)