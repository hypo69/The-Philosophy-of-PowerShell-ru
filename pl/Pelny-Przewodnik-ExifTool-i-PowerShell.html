<h1>PeÅ‚ny przewodnik po ExifTool i PowerShell</h1>
<p>Za kaÅ¼dym razem, gdy robisz zdjÄ™cie, aparat zapisuje w pliku nie tylko sam obraz, ale takÅ¼e informacje serwisowe: model aparatu i obiektywu, datÄ™ i godzinÄ™ wykonania zdjÄ™cia, czas naÅ›wietlania, przysÅ‚onÄ™, ISO, wspÃ³Å‚rzÄ™dne GPS. Dane te nazywane sÄ… **EXIF (Exchangeable Image File Format)**.</p>
<p>ChociaÅ¼ PowerShell ma wbudowane narzÄ™dzia do odczytu niektÃ³rych metadanych, sÄ… one ograniczone. Aby uzyskaÄ‡ dostÄ™p do **wszystkich** informacji, potrzebne jest specjalistyczne narzÄ™dzie. W tym artykule uÅ¼ywam **ExifTool**.</p>
<p>**ExifTool** to darmowe, wieloplatformowe narzÄ™dzie o otwartym kodzie ÅºrÃ³dÅ‚owym, napisane przez Phila Harveya. Jest to zÅ‚oty standard do odczytu, zapisu i edycji metadanych w szerokiej gamie formatÃ³w plikÃ³w (obrazy, audio, wideo, PDF itp.). ExifTool zna tysiÄ…ce tagÃ³w od setek producentÃ³w urzÄ…dzeÅ„, co czyni go najbardziej wszechstronnym narzÄ™dziem w swojej klasie.</p>
<h3>Pobieranie i prawidÅ‚owa konfiguracja</h3>
<p>Zanim zaczniesz pisaÄ‡ kod, musisz przygotowaÄ‡ samo narzÄ™dzie.</p>
<ol>
<li>PrzejdÅº na **oficjalnÄ… stronÄ™ ExifTool: <a href="https://exiftool.org/">https://exiftool.org/</a>**. Na stronie gÅ‚Ã³wnej znajdÅº i pobierz **"Windows Executable"**.

2.  **Zmiana nazwy (Krok krytyczny!):** Pobrany plik bÄ™dzie nosiÅ‚ nazwÄ™ <code>exiftool(-k).exe</code>. To nie przypadek.</li>
</ol>
<p>ZmieÅ„ jego nazwÄ™ na **<code>exiftool.exe</code>**, aby **wyÅ‚Ä…czyÄ‡ tryb "pauzy"**, ktÃ³ry jest przeznaczony dla uÅ¼ytkownikÃ³w uruchamiajÄ…cych program podwÃ³jnym klikniÄ™ciem myszy.</p>
<blockquote>
<p></p>
</blockquote>
<ol>
<li>**Przechowywanie:** Masz dwie gÅ‚Ã³wne opcje przechowywania <code>exiftool.exe</code>.
<ul>
<li>**Opcja 1 (Prosta): W tym samym folderze co TwÃ³j skrypt.** To najÅ‚atwiejsza droga. TwÃ³j skrypt PowerShell zawsze bÄ™dzie mÃ³gÅ‚ znaleÅºÄ‡ narzÄ™dzie, poniewaÅ¼ znajduje siÄ™ obok. Idealne dla przenoÅ›nych skryptÃ³w, ktÃ³re przenosisz z komputera na komputer.</li>
<li>**Opcja 2 (Zalecana do czÄ™stego uÅ¼ytku): W folderze ze zmiennej systemowej <code>PATH</code>.** Zmienna <code>PATH</code> â€” to lista katalogÃ³w, w ktÃ³rych Windows i PowerShell automatycznie szukajÄ… plikÃ³w wykonywalnych.<br />MoÅ¼esz utworzyÄ‡ folder (np. <code>C:\Tools</code>), umieÅ›ciÄ‡ tam <code>exiftool.exe</code> i dodaÄ‡ <code>C:\Tools</code> do zmiennej systemowej <code>PATH</code>.<br />NastÄ™pnie bÄ™dziesz mÃ³gÅ‚ wywoÅ‚ywaÄ‡ <code>exiftool.exe</code> z dowolnego folderu w dowolnej konsoli.</li>
</ul>
</li>
</ol>
<p>Skrypty do dodania do $PATH:<br />Dodawanie katalogu do PATH dla OBECNEGO UÅ»YTKOWNIKA<br />Dodawanie katalogu do SYSTEMOWEGO PATH dla WSZYSTKICH UÅ»YTKOWNIKÃ“W</p>
<hr />
<h2>PowerShell i programy zewnÄ™trzne</h2>
<p>Aby skutecznie korzystaÄ‡ z ExifTool, musisz wiedzieÄ‡, jak PowerShell uruchamia zewnÄ™trzne pliki <code>.exe</code>.<br />PrawidÅ‚owym i najbardziej niezawodnym sposobem uruchamiania programÃ³w zewnÄ™trznych jest **operator wywoÅ‚ania <code>&amp;</code> (ampersand)**.<br />PowerShell zgÅ‚osi bÅ‚Ä…d, jeÅ›li Å›cieÅ¼ka do programu zawiera spacje. Na przykÅ‚ad <code>C:\My Tools\exiftool.exe</code>.<br /><code>&amp;</code> (ampersand)** mÃ³wi PowerShell: "Tekst, ktÃ³ry nastÄ™puje po mnie w cudzysÅ‚owach, to Å›cieÅ¼ka do pliku wykonywalnego. Uruchom go, a wszystko, co nastÄ™puje dalej, to jego argumenty".</p>
<pre class="line-numbers"><code class="language-powershell"># PrawidÅ‚owa skÅ‚adnia
&amp; "C:\Path With Spaces\program.exe" "Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚ 1" "Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚ 2"
</code></pre>
<p>Zawsze uÅ¼ywaj <code>&amp;</code>, gdy pracujesz ze Å›cieÅ¼kami do programÃ³w w zmiennych lub Å›cieÅ¼kami, ktÃ³re mogÄ… zawieraÄ‡ spacje.</p>
<hr />
<h2>Praktyczne sztuczki: ExifTool + PowerShell</h2>
<p>Teraz poÅ‚Ä…czmy naszÄ… wiedzÄ™.</p>
<h3>PrzykÅ‚ad nr 1: Podstawowe wyodrÄ™bnianie i interaktywny podglÄ…d</h3>
<p>Najprostszym sposobem na uzyskanie wszystkich danych ze zdjÄ™cia i ich zbadanie jest zaÅ¼Ä…danie ich w formacie JSON i przekazanie do <code>Out-ConsoleGridView</code>.</p>
<pre class="line-numbers"><code class="language-powershell">
$photoPath = "D:\Photos\IMG_1234.JPG"

# 1. Uruchamiamy exiftool z przeÅ‚Ä…cznikiem -json dla ustrukturyzowanego wyjÅ›cia
# 2. Konwertujemy tekst JSON na obiekt PowerShell
#    WywoÅ‚ujemy exiftool.exe bezpoÅ›rednio, bez zmiennej i operatora wywoÅ‚ania &amp;.
$exifObject = exiftool.exe -json $photoPath | ConvertFrom-Json

# 3. PrzeksztaÅ‚camy "szeroki" obiekt w wygodnÄ… tabelÄ™ "Parametr-WartoÅ›Ä‡"
$reportData = $exifObject.psobject.Properties | Select-Object Name, Value

# 4. WyÅ›wietlamy wynik w interaktywnym oknie do analizy
$reportData | Out-ConsoleGridView -Title "Metadane pliku: $($photoPath | Split-Path -Leaf)"
</code></pre>
<p>Ten kod otworzy interaktywne okno, w ktÃ³rym bÄ™dziesz mÃ³gÅ‚ sortowaÄ‡ dane wedÅ‚ug nazwy parametru lub wartoÅ›ci, a takÅ¼e filtrowaÄ‡ je, po prostu zaczynajÄ…c wpisywaÄ‡ tekst. Jest to niezwykle wygodne do szybkiego wyszukiwania potrzebnych informacji.</p>
<h3>PrzykÅ‚ad nr 2: Tworzenie czystego raportu i wysyÅ‚anie na rÃ³Å¼ne "urzÄ…dzenia"</h3>
<p><code>Out-ConsoleGridView</code> to dopiero poczÄ…tek. Przetworzone dane moÅ¼esz wysÅ‚aÄ‡ w dowolne miejsce, uÅ¼ywajÄ…c innych cmdletÃ³w <code>Out-*</code>.</p>
<p>ZaÅ‚Ã³Å¼my, Å¼e mamy dane w zmiennej <code>$reportData</code> z poprzedniego przykÅ‚adu.

<h4>**A) WysyÅ‚anie do pliku CSV dla Excela**</h4>
<pre class="line-numbers"><code class="language-powershell">$reportData | Export-Csv -Path "C:\Reports\photo_exif.csv" -NoTypeInformation -Encoding UTF8
</code></pre>
<p>Polecenie <code>Export-Csv</code> tworzy idealnie ustrukturyzowany plik, ktÃ³ry moÅ¼na otworzyÄ‡ w Excelu lub Arkuszach Google.</p>
<h4>**B) WysyÅ‚anie do pliku tekstowego**</h4>
<pre class="line-numbers"><code class="language-powershell"># Aby uzyskaÄ‡ Å‚adne formatowanie, najpierw uÅ¼yj Format-Table
$reportData | Format-Table -AutoSize | Out-File -FilePath "C:\Reports\photo_exif.txt"
</code></pre>
<p>Polecenie <code>Out-File</code> zapisze do pliku dokÅ‚adnÄ… tekstowÄ… kopiÄ™ tego, co widzisz w konsoli.</p>
<h4>**C) WysyÅ‚anie do schowka**</h4>
<p>Chcesz szybko wkleiÄ‡ dane do wiadomoÅ›ci e-mail lub czatu? UÅ¼yj <code>Out-Clipboard</code>.
<pre class="line-numbers"><code class="language-powershell">$reportData | Format-Table -AutoSize | Out-String | Out-Clipboard
</code></pre>
<p>Teraz moÅ¼esz nacisnÄ…Ä‡ <code>Ctrl+V</code> w dowolnym edytorze tekstu i wkleiÄ‡ starannie sformatowanÄ… tabelÄ™.</p>
<h3>PrzykÅ‚ad nr 3: Uzyskiwanie konkretnych danych do wykorzystania w skrypcie</h3>
<p>CzÄ™sto nie potrzebujesz caÅ‚ego raportu, a jedynie jednej lub dwÃ³ch wartoÅ›ci. PoniewaÅ¼ <code>$exifObject</code> jest zwykÅ‚ym obiektem PowerShell, moÅ¼esz Å‚atwo odwoÅ‚ywaÄ‡ siÄ™ do jego wÅ‚aÅ›ciwoÅ›ci.</p>
<pre class="line-numbers"><code class="language-powershell">
$photoPath = "D:\Photos\IMG_1234.JPG"

# WywoÅ‚ujemy exiftool.exe bezpoÅ›rednio po nazwie.
# PowerShell automatycznie znajdzie go w jednym z folderÃ³w wymienionych w PATH.
$exifObject = exiftool.exe -json $photoPath | ConvertFrom-Json

# 1. Tworzymy jeden obiekt PowerShell z czytelnymi nazwami wÅ‚aÅ›ciwoÅ›ci.
#    To podobne do tworzenia ustrukturyzowanego rekordu.
$reportObject = [PSCustomObject]@{
    "Kamera"           = $exifObject.Model
    "Data wykonania"      = $exifObject.DateTimeOriginal
    "CzuÅ‚oÅ›Ä‡" = $exifObject.ISO
    "Nazwa pliku"        = $exifObject.FileName # Dodaj nazwÄ™ pliku dla kontekstu
}

# 2. WyÅ›wietlamy ten obiekt w interaktywnym oknie.
#    Out-GridView automatycznie utworzy kolumny z nazw wÅ‚aÅ›ciwoÅ›ci.
$reportObject | Out-ConsoleGridView -Title "Metadane pliku: $($photoPath | Split-Path -Leaf)"
</code></pre>
<p>To podejÅ›cie jest podstawÄ… kaÅ¼dej powaÅ¼nej automatyzacji, takiej jak zmiana nazw plikÃ³w na podstawie daty wykonania zdjÄ™cia, sortowanie zdjÄ™Ä‡ wedÅ‚ug modelu aparatu lub dodawanie znakÃ³w wodnych z informacjami o czasie naÅ›wietlania.</p>
<h3>PrzykÅ‚ad nr 4: Zbiorcze wyodrÄ™bnianie metadanych z folderu</h3>
<p>Czasami trzeba przeanalizowaÄ‡ nie jedno zdjÄ™cie, ale caÅ‚y folder z obrazami.</p>
<pre class="line-numbers"><code class="language-powershell"># Podaj tylko folder ze zdjÄ™ciami.
$photoFolder = "D:\Photos"

# WywoÅ‚ujemy exiftool.exe bezpoÅ›rednio. Zmienna dla Å›cieÅ¼ki i operator &amp; nie sÄ… potrzebne.
$allExif = exiftool.exe -json "$photoFolder\*.jpg" | ConvertFrom-Json

# PrzeksztaÅ‚camy w wygodnÄ… formÄ™
$report = foreach ($photo in $allExif) {
    [PSCustomObject]@{
        # --- Podstawowe dane o pliku i aparacie ---
        FileName       = $photo.FileName
        DateTime       = $photo.DateTimeOriginal
        CameraMake     = $photo.Make                 # Producent (np. "Canon", "SONY")
        CameraModel    = $photo.Model                 # Model aparatu (np. "EOS R5")
        LensModel      = $photo.LensID                # PeÅ‚na nazwa modelu obiektywu
        
        # --- Parametry fotografowania (ekspozycja) ---
        ISO            = $photo.ISO
        ShutterSpeed   = $photo.ShutterSpeed
        Aperture       = $photo.Aperture
        FocalLength    = $photo.FocalLength           # Ogniskowa (np. "50.0 mm")
        ExposureMode   = $photo.ExposureProgram       # Tryb fotografowania (np. "Manual", "Aperture Priority")
        Flash          = $photo.Flash                 # Informacje o tym, czy lampa bÅ‚yskowa zadziaÅ‚aÅ‚a
        
        # --- GPS i dane obrazu ---
        GPSPosition    = $photo.GPSPosition           # WspÃ³Å‚rzÄ™dne GPS w postaci jednego ciÄ…gu (jeÅ›li istniejÄ…)
        Dimensions     = "$($photo.ImageWidth)x$($photo.ImageHeight)" # Rozmiary obrazu w pikselach
    }
}

# WyÅ›wietlamy dane w interaktywnej tabeli w KONSOLI
$report | Out-ConsoleGridView -Title "Raport zbiorczy dla folderu: $photoFolder"
</code></pre>
<p>ğŸ’¡ Otrzymujesz schludnÄ… tabelÄ™ dla caÅ‚ego folderu od razu.</p>
<hr />
<h3>PrzykÅ‚ad nr 5: Rekurencyjne wyszukiwanie w podfolderach</h3>
<p>ExifTool potrafi sam wyszukiwaÄ‡ pliki we wszystkich podfolderach, uÅ¼ywajÄ…c przeÅ‚Ä…cznika <code>-r</code>.</p>
<pre class="line-numbers"><code class="language-powershell">&amp; $exifToolPath -r -json "D:\Photos" | ConvertFrom-Json |
    Select-Object FileName, Model, DateTimeOriginal |
    Export-Csv "C:\Reports\all_photos_recursive.csv" -NoTypeInformation -Encoding UTF8
</code></pre>
<hr />
<h3>PrzykÅ‚ad nr 6: Zmiana nazw plikÃ³w wedÅ‚ug daty wykonania zdjÄ™cia</h3>
<p>Jest to jeden z najpopularniejszych scenariuszy automatyzacji â€” pliki otrzymujÄ… nazwy wedÅ‚ug daty/godziny wykonania zdjÄ™cia.</p>
<pre class="line-numbers"><code class="language-powershell">$exifToolPath = "C:\Tools\exiftool.exe"
$photoFolder = "D:\Photos"

# ZmieÅ„ nazwÄ™ na format RRRR-MM-DD_GG-MM-SS.jpg
&amp; $exifToolPath -r -d "%Y-%m-%d_%H-%M-%S.%%e" "-FileName&lt;DateTimeOriginal" $photoFolder
</code></pre>
<p>ğŸ’¡ <em>ExifTool automatycznie wstawi rozszerzenie oryginalnego pliku za pomocÄ… <code>%%e</code>.</em></p>
<hr />
<h3>PrzykÅ‚ad nr 7: WyodrÄ™bnianie tylko wspÃ³Å‚rzÄ™dnych GPS</h3>
<p>Przydatne, jeÅ›li chcesz zbudowaÄ‡ mapÄ™ na podstawie swoich zdjÄ™Ä‡.</p>
<pre class="line-numbers"><code class="language-powershell"># 1. Podaj Å›cieÅ¼kÄ™ do folderu ze zdjÄ™ciami
$photoFolder = "E:\DCIM\Camera"

# 2. WymieÅ„ tagi, ktÃ³rych potrzebujemy: nazwa pliku i trzy tagi GPS.
#    To sprawia, Å¼e zapytanie jest znacznie szybsze, niÅ¼ gdybyÅ›my pobierali wszystkie tagi.
$tagsToExtract = @(
    "-SourceFile", # SourceFile jest lepsze niÅ¼ FileName, poniewaÅ¼ zazwyczaj zawiera peÅ‚nÄ… Å›cieÅ¼kÄ™
    "-GPSLatitude",
    "-GPSLongitude",
    "-GPSAltitude"
)

# 3. WywoÅ‚ujemy exiftool.exe bezpoÅ›rednio (poniewaÅ¼ jest w PATH).
#    PrzeÅ‚Ä…cznik -r wyszukuje pliki we wszystkich podfolderach.
#    Wynik od razu konwertujemy z JSON.
$allExifData = exiftool.exe -r -json $tagsToExtract $photoFolder | ConvertFrom-Json

# 4. Filtrujemy wyniki: pozostawiamy TYLKO te obiekty, ktÃ³re majÄ… szerokoÅ›Ä‡ i dÅ‚ugoÅ›Ä‡ geograficznÄ….
$filesWithGps = $allExifData | Where-Object { $_.GPSLatitude -and $_.GPSLongitude }

# 5. Sprawdzamy, czy w ogÃ³le znaleziono pliki z danymi GPS
if ($filesWithGps) {
    # 6. Tworzymy Å‚adny raport z przefiltrowanych danych.
    #    UÅ¼ywamy Select-Object do zmiany nazw kolumn i formatowania.
    $report = $filesWithGps | Select-Object @{Name="Nazwa pliku"; Expression={Split-Path $_.SourceFile -Leaf}},
                                             @{Name="SzerokoÅ›Ä‡ geograficzna"; Expression={$_.GPSLatitude}},
                                             @{Name="DÅ‚ugoÅ›Ä‡ geograficzna"; Expression={$_.GPSLongitude}},
                                             @{Name="WysokoÅ›Ä‡"; Expression={if ($_.GPSAltitude) { "$($_.GPSAltitude) m" } else { "N/A" }}}
    
    # 7. WyÅ›wietlamy koÅ„cowy raport w interaktywnej tabeli konsoli.
    $report | Out-ConsoleGridView -Title "Pliki z danymi GPS w folderze: $photoFolder"

} else {
    # JeÅ›li nic nie znaleziono, uprzejmie o tym informujemy.
    Write-Host "Nie znaleziono plikÃ³w z danymi GPS w folderze '$photoFolder'." -ForegroundColor Yellow
}
```

---

### PrzykÅ‚ad nr 8: Masowe usuwanie wszystkich danych GPS (dla prywatnoÅ›ci)

```powershell
# UsuÅ„ wszystkie tagi GPS z JPG i PNG
& $exifToolPath -r -overwrite_original -gps:all= "D:\Photos"
```

ğŸ’¡ *Ta operacja jest nieodwracalna, dlatego przed jej wykonaniem wykonaj kopiÄ™ zapasowÄ….*

---

### PrzykÅ‚ad nr 9: Konwersja czasu wykonania zdjÄ™cia na czas lokalny

Czasami zdjÄ™cia sÄ… robione w innej strefie czasowej. ExifTool moÅ¼e przesunÄ…Ä‡ datÄ™.

```powershell
# PrzesuÅ„ czas o +3 godziny
& $exifToolPath "-AllDates+=3:0:0" "D:\Photos\IMG_*.JPG"
```

---

### PrzykÅ‚ad nr 10: Uzyskiwanie listy wszystkich unikalnych modeli aparatÃ³w w folderze

```powershell
$models = & $exifToolPath -r -Model -s3 "D:\Photos" | Sort-Object -Unique
$models | ForEach-Object { Write-Host "Model: $_" }
```

---

### PrzykÅ‚ad nr 11: WyÅ›wietlanie tylko potrzebnych tagÃ³w w formie tabelarycznej

```powershell
& $exifToolPath -T -Model -DateTimeOriginal -ISO -Aperture -ShutterSpeed "D:\Photos\IMG_1234.JPG"
```

`-T` wyÅ›wietla dane w formacie tabelarycznym, oddzielone tabulatorami â€” wygodne do dalszej obrÃ³bki.

---

### PrzykÅ‚ad nr 12: Sprawdzanie obecnoÅ›ci GPS w duÅ¼ej tablicy plikÃ³w

```powershell
$files = & $exifToolPath -r -if "$gpslatitude" -p '$FileName' "D:\Photos"
Write-Host "Pliki z GPS:"
$files
```

---

### PrzykÅ‚ad nr 13: Kopiowanie metadanych z jednego pliku do drugiego

```powershell
# 1. Wybierz plik referencyjny
$sourceFile = Get-ChildItem "D:\Photos" -Filter "*.jpg" | Out-ConsoleGridView -Title "Wybierz PLIK REFERENCYJNY"

# 2. JeÅ›li plik referencyjny zostaÅ‚ wybrany, wybierz pliki docelowe
if ($sourceFile) {
    $targetFiles = Get-ChildItem "D:\Photos\New" -Filter "*.jpg" | Out-ConsoleGridView -Title "Wybierz PLIKI DOCELOWE do kopiowania metadanych" -OutputMode Multiple
    
    # 3. JeÅ›li cele zostaÅ‚y wybrane, wykonaj kopiowanie
    if ($targetFiles) {
        & exiftool.exe -TagsFromFile $sourceFile.FullName ($targetFiles.FullName)
        Write-Host "Metadane skopiowane z $($sourceFile.Name) do $($targetFiles.Count) plikÃ³w."
    }
}
```

---

### PrzykÅ‚ad nr 14: Zapisywanie oryginalnych metadanych do oddzielnego pliku JSON przed zmianÄ…

```powershell
$backupPath = "C:\Reports\metadata_backup.json"
& $exifToolPath -r -json "D:\Photos" | Out-File -Encoding UTF8 $backupPath
```

---

### PrzykÅ‚ad nr 15: UÅ¼ycie PowerShell do automatycznego sortowania zdjÄ™Ä‡ wedÅ‚ug daty

```powershell
$photos = Get-ChildItem "D:\Photos" -Filter *.jpg -Recurse
foreach ($photo in $photos) {
    $meta = & $exifToolPath -json $photo.FullName | ConvertFrom-Json
    $date = Get-Date $meta.DateTimeOriginal -ErrorAction SilentlyContinue
    if ($date) {
        $targetFolder = "D:\Sorted\{0:yyyy}\{0:MM}" -f $date
        if (-not (Test-Path $targetFolder)) { New-Item -Path $targetFolder -ItemType Directory }
        Move-Item $photo.FullName -Destination $targetFolder
    }
}
```

---


### PrzykÅ‚ad 16: Wyszukiwanie wszystkich unikalnych modeli aparatÃ³w w kolekcji

ChociaÅ¼ moÅ¼na to zrobiÄ‡ w jednej linii, wyÅ›wietlanie w `GridView` pozwala od razu skopiowaÄ‡ potrzebnÄ… nazwÄ™ modelu.

```powershell
# PrzeÅ‚Ä…cznik -s3 wyÅ›wietla tylko wartoÅ›ci, -Model - nazwÄ™ tagu
$uniqueModels = & exiftool.exe -r -Model -s3 "D:\Photos" | Sort-Object -Unique

# WyÅ›wietl w GridView dla Å‚atwego przeglÄ…dania i kopiowania
$uniqueModels | Out-ConsoleGridView -Title "Unikalne modele aparatÃ³w w kolekcji"
```
