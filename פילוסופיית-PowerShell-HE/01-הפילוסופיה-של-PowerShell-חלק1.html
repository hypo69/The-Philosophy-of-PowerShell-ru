<h1 dir="rtl">הפילוסופיה של PowerShell.</h1>
<h2 dir="rtl">חלק 0.</h2>
<p dir="rtl">מה היה לפני PowerShell?
בשנת 1981, יצאה MS-DOS 1.0 עם מפרש הפקודות <span dir="ltr"><code>COMMAND.COM</code></span>. לאוטומציה של משימות, נעשה שימוש ב<strong>קבצי אצווה (<span dir="ltr"><code>.bat</code></span>)</strong> — קבצי טקסט פשוטים עם רצף של פקודות קונסולה. זו הייתה סגפנות מפתיעה בשורת הפקודה בהשוואה למערכות תואמות POSIX, שבהן ה-<strong>Bourne shell (<span dir="ltr"><code>sh</code></span>)</strong> היה קיים מאז 1979.</p>
<h3 dir="rtl">📅 מצב שוק המעטפות בזמן יציאת MS-DOS 1.0 (אוגוסט 1981)</h3>
<p dir="rtl">הנה טבלת סיכום של מערכות הפעלה פופולריות באותה תקופה ותמיכתן במעטפות (<span dir="ltr"><code>sh</code></span>, <span dir="ltr"><code>csh</code></span> וכו'):</p>
<table>
<thead>
<tr>
<th dir="rtl">מערכת הפעלה</th>
<th dir="rtl">תמיכה במעטפות (<span dir="ltr"><code>sh</code></span>, <span dir="ltr"><code>csh</code></span> וכו')</th>
<th dir="rtl">הערה</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl"><strong><span dir="ltr">UNIX Version 7 (V7)</span></strong></td>
<td dir="rtl"><span dir="ltr"><code>sh</code></span></td>
<td dir="rtl">ה-UNIX הקלאסי האחרון של מעבדות בל, נפוץ מאוד</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">UNIX/32V</span></strong></td>
<td dir="rtl"><span dir="ltr"><code>sh</code></span>, <span dir="ltr"><code>csh</code></span></td>
<td dir="rtl">גרסת UNIX לארכיטקטורת VAX</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">4BSD / 3BSD</span></strong></td>
<td dir="rtl"><span dir="ltr"><code>sh</code></span>, <span dir="ltr"><code>csh</code></span></td>
<td dir="rtl">ענף אוניברסיטאי של UNIX מברקלי</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">UNIX System III</span></strong></td>
<td dir="rtl"><span dir="ltr"><code>sh</code></span></td>
<td dir="rtl">הגרסה המסחרית הראשונה של AT&amp;T, קודמו של System V</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">Xenix (של מיקרוסופט)</span></strong></td>
<td dir="rtl"><span dir="ltr"><code>sh</code></span></td>
<td dir="rtl">גרסה מורשית של UNIX, שנמכרה על ידי מיקרוסופט מאז 1980</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">IDRIS</span></strong></td>
<td dir="rtl"><span dir="ltr"><code>sh</code></span></td>
<td dir="rtl">מערכת הפעלה דמוית UNIX עבור PDP-11 ואינטל</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">Coherent (Mark Williams)</span></strong></td>
<td dir="rtl"><span dir="ltr"><code>sh</code></span> (דומה)</td>
<td dir="rtl">חלופה זולה ל-UNIX למחשבים אישיים</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">CP/M (Digital Research)</span></strong></td>
<td dir="rtl">❌ (אין <span dir="ltr"><code>sh</code></span>, רק CLI בסיסי מאוד)</td>
<td dir="rtl">לא UNIX, מערכת ההפעלה הפופולרית ביותר למחשבים אישיים של 8 סיביות</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">MS-DOS 1.0</span></strong></td>
<td dir="rtl">❌ (רק <span dir="ltr"><code>COMMAND.COM</code></span>)</td>
<td dir="rtl">מעטפת פקודות מינימלית, ללא סקריפטים או צינורות</td>
</tr>
</tbody>
</table>
<hr>
<h3 dir="rtl">💡 מהם <span dir="ltr"><code>sh</code></span>, <span dir="ltr"><code>csh</code></span></h3>
<ul>
<li dir="rtl"><span dir="ltr"><code>sh</code></span> — <strong><span dir="ltr">Bourne Shell</span></strong>, מפרש הסקריפטים העיקרי של UNIX מאז 1977.</li>
<li dir="rtl"><span dir="ltr"><code>csh</code></span> — <strong><span dir="ltr">C Shell</span></strong>, מעטפת משופרת עם תחביר דמוי C ונוחות לעבודה אינטראקטיבית.</li>
<li dir="rtl">מעטפות אלו <strong>תמכו בהפניות, צינורות, משתנים, פונקציות ותנאים</strong> — כל מה שהפך את UNIX לכלי אוטומציה רב עוצמה.</li>
</ul>
<hr>
<p dir="rtl">מיקרוסופט כיוונה ל<strong>מחשבי <span dir="ltr">IBM PC</span> זולים של 16 סיביות</strong>, שהיה להם <strong>מעט זיכרון</strong> (בדרך כלל 64–256 KB), ללא ריבוי משימות, ונועדו ל<strong>שימוש ביתי ומשרדי</strong>, לא לשרתים. UNIX הייתה יקרה, דרשה ארכיטקטורה מורכבת ומומחיות, בעוד שרואי חשבון ומהנדסים, לא מנהלי מערכות, היו זקוקים למערכת הפעלה מהירה ופשוטה.</p>
<p dir="rtl">במקום ה-<span dir="ltr"><code>sh</code></span> המורכב, ממשק ה-DOS סיפק קובץ יחיד, <span dir="ltr">command.com</span>, עם סט דל של פקודות פנימיות [ (dir, copy, del וכו')]<a href="https://www.techgeekbuzz.com/blog/dos-commands/" target="_blank">(dir, copy, del וכו')</a> ללא פונקציות, לולאות או מודולים.</p>
<p dir="rtl">היו גם פקודות חיצוניות — קבצי הפעלה נפרדים (<span dir="ltr">.exe</span> או <span dir="ltr">.com</span>). דוגמאות: <span dir="ltr">FORMAT.COM</span>, <span dir="ltr">XCOPY.EXE</span>, <span dir="ltr">CHKDSK.EXE</span>, <span dir="ltr">EDIT.COM</span>.
סקריפטים של ביצוע נכתבו בקובץ טקסט עם סיומת <span dir="ltr">.bat</span> (קובץ אצווה).</p>
<p dir="rtl">דוגמאות לקובצי תצורה:</p>
<ul>
<li dir="rtl">AUTOEXEC.BAT</li>
</ul>
<pre class="line-numbers"><code class="language-bash">:: ------------------------------------------------------------------------------
:: AUTOEXEC.BAT — תצורה והפעלה אוטומטית של Windows 3.11
:: מחבר: hypo69
:: שנה: בערך 1993
:: מטרה: מאתחל את סביבת ה-DOS, טוען מנהלי התקנים של רשת ומפעיל את Windows 3.11
:: ------------------------------------------------------------------------------
@ECHO OFF

:: הגדרת שורת הפקודה
PROMPT $p$g

:: הגדרת משתני סביבה
SET TEMP=C:\TEMP
PATH=C:\DOS;C:\WINDOWS

:: טעינת מנהלי התקנים וכלי עזר לזיכרון העליון
LH C:\DOS\SMARTDRV.EXE       :: מטמון דיסק
LH C:\DOS\MOUSE.COM          :: מנהל התקן של עכבר

:: טעינת שירותי רשת (רלוונטי עבור Windows for Workgroups 3.11)
IF EXIST C:\NET\NET.EXE LH C:\NET\NET START

:: הפעלה אוטומטית של Windows
WIN
</code></pre>
<ul>
<li dir="rtl">CONFIG.SYS</li>
</ul>
<pre class="line-numbers"><code class="language-bash">:: ------------------------------------------------------------------------------
:: CONFIG.SYS — תצורת זיכרון ומנהלי התקנים של DOS עבור Windows 3.11
:: מחבר: hypo69
:: שנה: בערך 1993
:: מטרה: מאתחל מנהלי התקנים של זיכרון, מגדיר פרמטרים של המערכת
:: ------------------------------------------------------------------------------
DEVICE=C:\DOS\HIMEM.SYS
DEVICE=C:\DOS\EMM386.EXE NOEMS
DOS=HIGH,UMB
FILES=40
BUFFERS=30
DEVICEHIGH=C:\DOS\SETVER.EXE
</code></pre>
<p dir="rtl">במקביל ל-DOS, מיקרוסופט החלה כמעט מיד לפתח ליבה חדשה ביסודה.</p>
<p dir="rtl">ליבת <a href="https://www.wikiwand.com/ru/articles/Windows_NT" target="_blank"><strong><span dir="ltr">Windows NT</span></strong></a> (טכנולוגיה חדשה) הופיעה לראשונה עם יציאת מערכת ההפעלה:</p>
<blockquote>
<p dir="rtl"><strong><span dir="ltr">Windows NT 3.1</span> — 27 ביולי 1993</strong></p>
</blockquote>
<hr>
<ul>
<li dir="rtl"><strong>הפיתוח החל</strong>: בשנת <strong>1988</strong> בהנהגתו של <strong>דייב קאטלר</strong> (מהנדס <span dir="ltr">DEC</span> לשעבר ויוצר <span dir="ltr">VMS</span>) במטרה ליצור מערכת הפעלה חדשה לחלוטין, מאובטחת, ניידת ורב-משימתית, שאינה תואמת ל-MS-DOS ברמת הליבה.</li>
<li dir="rtl"><strong><span dir="ltr">NT 3.1</span></strong> — נקראה כך כדי להדגיש תאימות עם <strong><span dir="ltr">Windows 3.1</span></strong> ברמת הממשק, אך זו הייתה <strong>ארכיטקטורה חדשה לחלוטין</strong>.</li>
</ul>
<hr>
<h4 dir="rtl">🧠 מה הביאה ליבת ה-NT:</h4>
<table>
<thead>
<tr>
<th dir="rtl">תכונה</th>
<th dir="rtl">תיאור</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl"><strong>ארכיטקטורת 32 סיביות</strong></td>
<td dir="rtl">בניגוד ל-MS-DOS ו-Windows 3.x, שהיו 16 סיביות.</td>
</tr>
<tr>
<td dir="rtl"><strong>ריבוי משימות</strong></td>
<td dir="rtl">ריבוי משימות מקדים אמיתי.</td>
</tr>
<tr>
<td dir="rtl"><strong>זיכרון מוגן</strong></td>
<td dir="rtl">תוכניות לא יכלו להשחית זו את הזיכרון של זו.</td>
</tr>
<tr>
<td dir="rtl"><strong>מודולריות</strong></td>
<td dir="rtl">ארכיטקטורת ליבה רב-שכבתית: <span dir="ltr">HAL</span>, <span dir="ltr">Executive</span>, <span dir="ltr">Kernel</span>, מנהלי התקנים.</td>
</tr>
<tr>
<td dir="rtl"><strong>תמיכה בריבוי פלטפורמות</strong></td>
<td dir="rtl"><span dir="ltr">NT 3.1</span> רץ על <span dir="ltr">x86</span>, <span dir="ltr">MIPS</span> ו-<span dir="ltr">Alpha</span>.</td>
</tr>
<tr>
<td dir="rtl"><strong>תאימות <span dir="ltr">POSIX</span></strong></td>
<td dir="rtl"><span dir="ltr">NT</span> הגיע עם <strong>תת-מערכת <span dir="ltr">POSIX</span></strong>, שאושרה ל-<span dir="ltr">POSIX.1</span>.</td>
</tr>
</tbody>
</table>
<hr>
<h4 dir="rtl">📜 שושלת ה-NT:</h4>
<table>
<thead>
<tr>
<th dir="rtl">גרסת <span dir="ltr">NT</span></th>
<th dir="rtl">שנה</th>
<th dir="rtl">הערה</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl"><span dir="ltr">NT 3.1</span></td>
<td dir="rtl">1993</td>
<td dir="rtl">מהדורת <span dir="ltr">NT</span> ראשונה</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr">NT 3.5 / 3.51</span></td>
<td dir="rtl">1994–1995</td>
<td dir="rtl">שיפורים, אופטימיזציה</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr">NT 4.0</span></td>
<td dir="rtl">1996</td>
<td dir="rtl">ממשק <span dir="ltr">Windows 95</span>, אבל ליבת <span dir="ltr">NT</span></td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr">Windows 2000</span></td>
<td dir="rtl">2000</td>
<td dir="rtl"><span dir="ltr">NT 5.0</span></td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr">Windows XP</span></td>
<td dir="rtl">2001</td>
<td dir="rtl"><span dir="ltr">NT 5.1</span></td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr">Windows Vista</span></td>
<td dir="rtl">2007</td>
<td dir="rtl"><span dir="ltr">NT 6.0</span></td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr">Windows 10</span></td>
<td dir="rtl">2015</td>
<td dir="rtl"><span dir="ltr">NT 10.0</span></td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr">Windows 11</span></td>
<td dir="rtl">2021</td>
<td dir="rtl">גם <span dir="ltr">NT 10.0</span> (שיווק 😊)</td>
</tr>
</tbody>
</table>
<hr>
<p dir="rtl">הבדל ביכולות מערכת ההפעלה:</p>
<table>
<thead>
<tr>
<th dir="rtl">מאפיין</th>
<th dir="rtl"><strong><span dir="ltr">MS-DOS</span></strong> (1981)</th>
<th dir="rtl"><strong><span dir="ltr">Windows NT</span></strong> (1993)</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl"><strong>סוג מערכת</strong></td>
<td dir="rtl">מונוליטית, חד-משימתית</td>
<td dir="rtl">מיקרו-ליבה/היברידית, רב-משימתית</td>
</tr>
<tr>
<td dir="rtl"><strong>סיביות</strong></td>
<td dir="rtl">16 סיביות</td>
<td dir="rtl">32 סיביות (עם תמיכה ב-64 סיביות מאז <span dir="ltr">NT 5.2 / XP x64</span>)</td>
</tr>
<tr>
<td dir="rtl"><strong>ריבוי משימות</strong></td>
<td dir="rtl">❌ נעדר (תהליך אחד בכל פעם)</td>
<td dir="rtl">✅ ריבוי משימות מקדים</td>
</tr>
<tr>
<td dir="rtl"><strong>זיכרון מוגן</strong></td>
<td dir="rtl">❌ לא</td>
<td dir="rtl">✅ כן (כל תהליך במרחב הכתובות שלו)</td>
</tr>
<tr>
<td dir="rtl"><strong>מצב ריבוי משתמשים</strong></td>
<td dir="rtl">❌ לא</td>
<td dir="rtl">✅ חלקית (ב-<span dir="ltr">NT Workstation/Server</span>)</td>
</tr>
<tr>
<td dir="rtl"><strong>תאימות <span dir="ltr">POSIX</span></strong></td>
<td dir="rtl">❌ לא</td>
<td dir="rtl">✅ תת-מערכת <span dir="ltr">POSIX</span> מובנית ב-<span dir="ltr">NT 3.1–5.2</span></td>
</tr>
<tr>
<td dir="rtl"><strong>ניידות ליבה</strong></td>
<td dir="rtl">❌ <span dir="ltr">x86</span> בלבד</td>
<td dir="rtl">✅ <span dir="ltr">x86</span>, <span dir="ltr">MIPS</span>, <span dir="ltr">Alpha</span>, <span dir="ltr">PowerPC</span></td>
</tr>
<tr>
<td dir="rtl"><strong>מנהלי התקנים</strong></td>
<td dir="rtl">גישה ישירה לחומרה</td>
<td dir="rtl">דרך <span dir="ltr">HAL</span> ומנהלי התקנים במצב ליבה</td>
</tr>
<tr>
<td dir="rtl"><strong>רמת גישה ליישומים</strong></td>
<td dir="rtl">יישומים = רמת מערכת</td>
<td dir="rtl">רמות משתמש/ליבה מופרדות</td>
</tr>
<tr>
<td dir="rtl"><strong>אבטחה</strong></td>
<td dir="rtl">❌ נעדרת</td>
<td dir="rtl">✅ מודל אבטחה: <span dir="ltr">SID</span>, <span dir="ltr">ACL</span>, אסימוני גישה</td>
</tr>
<tr>
<td dir="rtl"><strong>יציבות</strong></td>
<td dir="rtl">❌ תלות של תוכנית אחת = קריסת מערכת ההפעלה</td>
<td dir="rtl">✅ בידוד תהליכים, הגנה על הליבה</td>
</tr>
</tbody>
</table>
<hr>
<p dir="rtl">אבל היה אבל גדול אחד! כלי אוטומציה וניהול לא קיבלו תשומת לב ראויה עד 2002.</p>
<hr>
<p dir="rtl">מיקרוסופט השתמשה בגישות, אסטרטגיות וכלים שונים לחלוטין לניהול. כל זה היה <strong>מפוזר</strong>, לעתים קרובות מוכוון <span dir="ltr">GUI</span>, ולא תמיד ניתן לאוטומציה.</p>
<hr>
<h5 dir="rtl">📌 רשימה של כמה כלים:</h5>
<table>
<thead>
<tr>
<th dir="rtl">כלי</th>
<th dir="rtl">מטרה</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl"><span dir="ltr"><code>cmd.exe</code></span></td>
<td dir="rtl">מפרש פקודות משופר (תחליף ל-<span dir="ltr"><code>COMMAND.COM</code></span>)</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>.bat</code></span>, <span dir="ltr"><code>.cmd</code></span></td>
<td dir="rtl">סקריפטים של שורת הפקודה</td>
</tr>
<tr>
<td dir="rtl"><strong><span dir="ltr">Windows Script Host (WSH)</span></strong></td>
<td dir="rtl">תמיכה ב-<span dir="ltr">VBScript</span> ו-<span dir="ltr">JScript</span> לאוטומציה</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>reg.exe</code></span></td>
<td dir="rtl">ניהול הרישום משורת הפקודה</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>net.exe</code></span></td>
<td dir="rtl">עבודה עם משתמשים, רשת, מדפסות</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>sc.exe</code></span></td>
<td dir="rtl">ניהול שירותים</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>tasklist</code></span>, <span dir="ltr"><code>taskkill</code></span></td>
<td dir="rtl">ניהול תהליכים</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>gpedit.msc</code></span></td>
<td dir="rtl">מדיניות קבוצתית (מקומית)</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>MMC</code></span></td>
<td dir="rtl">קונסולה עם יישומונים לניהול</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>WMI</code></span></td>
<td dir="rtl">גישה למידע מערכת (באמצעות <span dir="ltr"><code>wmic</code></span>, <span dir="ltr">VBScript</span> או <span dir="ltr">COM</span>)</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>WbemTest.exe</code></span></td>
<td dir="rtl"><span dir="ltr">GUI</span> לבדיקת שאילתות <span dir="ltr">WMI</span></td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>eventvwr</code></span></td>
<td dir="rtl">הצגת יומני אירועים</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>perfmon</code></span></td>
<td dir="rtl">ניטור משאבים</td>
</tr>
</tbody>
</table>
<h5 dir="rtl">🛠 דוגמאות לאוטומציה:</h5>
<ul>
<li dir="rtl">קבצי <span dir="ltr">VBScript</span> (<span dir="ltr"><code>*.vbs</code></span>) לניהול משתמשים, רשתות, מדפסות ושירותים.</li>
<li dir="rtl"><span dir="ltr"><code>WMIC</code></span> — ממשק שורת פקודה ל-<span dir="ltr">WMI</span> (לדוגמה: <span dir="ltr"><code>wmic process list brief</code></span>).</li>
<li dir="rtl">סקריפטים של <span dir="ltr"><code>.cmd</code></span> עם קריאות ל-<span dir="ltr"><code>net</code></span>, <span dir="ltr"><code>sc</code></span>, <span dir="ltr"><code>reg</code></span>, <span dir="ltr"><code>wmic</code></span> וכו'.</li>
</ul>
<hr>
<h3 dir="rtl">⚙️ <span dir="ltr">Windows Scripting Host (WSH)</span></h3>
<ul>
<li dir="rtl">הופיע לראשונה ב-<strong><span dir="ltr">Windows 98</span></strong>, היה בשימוש פעיל ב-<strong><span dir="ltr">Windows 2000</span> ו-<span dir="ltr">XP</span></strong>.</li>
<li dir="rtl">אפשר להריץ קבצי <span dir="ltr">VBScript</span> ו-<span dir="ltr">JScript</span> משורת הפקודה:</li>
</ul>
<pre class="line-numbers"><code class="language-vbscript">  Set objShell = WScript.CreateObject("WScript.Shell")
  objShell.Run "notepad.exe"
</code></pre>
<hr>
<h2 dir="rtl">חלק 1.</h2>
<p dir="rtl">רק בשנת 2002 החברה ניסחה את פרויקט <a href="https://learn.microsoft.com/en-us/powershell/scripting/developer/monad-manifesto?view=powershell-7.5" target="_blank">Monad</a>, שלימים התפתח ל-PowerShell:</p>
<p dir="rtl">תחילת הפיתוח: בערך בשנת 2002</p>
<p dir="rtl">הכרזה פומבית: 2003, בשם "<span dir="ltr">Monad Shell</span>"</p>
<p dir="rtl">גרסאות בטא ראשונות: הופיעו עד 2005</p>
<p dir="rtl">מהדורה סופית (<span dir="ltr">PowerShell 1.0</span>): נובמבר 2006</p>
<p dir="rtl">המחבר והארכיטקט הראשי של פרויקט <span dir="ltr">Monad / PowerShell</span> הוא ג'פרי סנובר
<a href="https://www.wikiwand.com/en/articles/Jeffrey_Snover" target="_blank"> (ג'פרי סנובר)</a></p>
<p dir="rtl">כיום <span dir="ltr">PowerShell Core</span> פועל על
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/windows-core.md" target="_blank">Windows</a>
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/macos.md" target="_blank">macOS</a>
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/linux.md" target="_blank">Linux</a></p>
<p dir="rtl">במקביל, פותחה מסגרת ה-<span dir="ltr">.NET</span>, ו-<span dir="ltr">PowerShell</span> שולבה בה לעומק. בפרקים הבאים אציג דוגמאות.</p>
<p dir="rtl">ועכשיו — הדבר החשוב ביותר!</p>
<p dir="rtl">היתרון העיקרי של <span dir="ltr">PowerShell</span> בהשוואה למעטפות פקודה קלאסיות הוא שהוא עובד עם <em>אובייקטים</em>, לא עם טקסט. כאשר אתה מבצע פקודה, היא מחזירה לך לא רק טקסט, אלא אובייקט מובנה (או אוסף של אובייקטים) שיש לו מאפיינים ושיטות מוגדרים היטב.</p>
<p dir="rtl">ראו כיצד <span dir="ltr">PowerShell</span> עולה על מעטפות קלאסיות בזכות <strong>עבודה עם אובייקטים</strong></p>
<h3 dir="rtl">📁 הדרך הישנה: <span dir="ltr"><code>dir</code></span> וניתוח ידני</h3>
<p dir="rtl">ב-<strong><span dir="ltr">CMD</span></strong> (הן ב-<span dir="ltr"><code>COMMAND.COM</code></span> הישן והן ב-<span dir="ltr"><code>cmd.exe</code></span>), הפקודה <span dir="ltr"><code>dir</code></span> מחזירה את התוצאה כטקסט רגיל. פלט לדוגמה:</p>
<pre class="line-numbers"><code>24.07.2025  21:15         1,428  my_script.js
25.07.2025  08:01         3,980  report.html
</code></pre>
<p dir="rtl">נניח שברצונך לחלץ את <strong>שם הקובץ</strong> ואת <strong>גודל</strong> כל קובץ. תצטרך לנתח את המחרוזות באופן ידני:
<pre class="line-numbers"><code class="language-cmd">for /f "tokens=5,6" %a in ('dir ^| findstr /R "[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]"') do @echo %a %b
</code></pre>
</p>
<ul>
<li dir="rtl">זה נורא קשה לקריאה, תלוי באזור, בפורמט התאריך ובגופן. וזה נשבר עם רווחים בשמות.</li>
</ul>
<hr>
<h3 dir="rtl">✅ <span dir="ltr">PowerShell</span>: אובייקטים במקום טקסט</h3>
<h4 dir="rtl">✔ דוגמה פשוטה וקריאה:</h4>
<pre class="line-numbers"><code class="language-powershell">Get-ChildItem | Select-Object Name, Length
</code></pre>
<p dir="rtl"><strong>תוצאה:</strong></p>
<pre class="line-numbers"><code>Name          Length
----          ------
my_script.js   1428
report.html    3980
</code></pre>
<ul>
<li dir="rtl"><span dir="ltr"><code>Get-ChildItem</code></span> מחזירה <strong>מערך של אובייקטים של קבצים/תיקיות</strong></li>
<li dir="rtl"><span dir="ltr"><code>Select-Object</code></span> מאפשר לך לקבל בקלות את ה<strong>מאפיינים</strong> הנדרשים</li>
</ul>
<hr>
<h3 dir="rtl">🔍 מה באמת מחזירה <span dir="ltr"><code>Get-ChildItem</code></span>?</h3>
<pre class="line-numbers"><code class="language-powershell">$item = Get-ChildItem -Path .\my_script.js
$item | Get-Member
</code></pre>
<p dir="rtl"><strong>תוצאה:</strong></p>
<pre class="line-numbers"><code>TypeName: System.IO.FileInfo

Name         MemberType     Definition
----         ---------      ----------
Length       Property       long Length {get;}
Name         Property       string Name {get;}
CreationTime Property       datetime CreationTime {get;set;}
Delete       Method         void Delete()
...
</code></pre>
<p dir="rtl"><span dir="ltr">PowerShell</span> מחזירה <strong>אובייקטים מסוג <span dir="ltr"><code>System.IO.FileInfo</code></span></strong>, שיש להם:</p>
<ul>
<li dir="rtl">🧱 מאפיינים (<span dir="ltr"><code>Name</code></span>, <span dir="ltr"><code>Length</code></span>, <span dir="ltr"><code>CreationTime</code></span>, <span dir="ltr"><code>Extension</code></span>, …)</li>
<li dir="rtl">🛠 שיטות (<span dir="ltr"><code>Delete()</code></span>, <span dir="ltr"><code>CopyTo()</code></span>, <span dir="ltr"><code>MoveTo()</code></span> וכו')</li>
</ul>
<p dir="rtl">אתה עובד <strong>עם אובייקטים מלאים</strong>, לא עם מחרוזות.</p>
<hr>
<h3 dir="rtl">תחביר "פועל-שם עצם":</h3>
<p dir="rtl"><span dir="ltr">PowerShell</span> משתמש ב<strong>תחביר פקודות קפדני והגיוני</strong>:
<span dir="ltr">`פועל-שם עצם` (Verb-Noun)</span></p>
<table>
<thead>
<tr>
<th dir="rtl">פועל</th>
<th dir="rtl">מה הוא עושה</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl"><span dir="ltr"><code>Get-</code></span></td>
<td dir="rtl">קבל</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>Set-</code></span></td>
<td dir="rtl">הגדר</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>New-</code></span></td>
<td dir="rtl">צור</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>Remove-</code></span></td>
<td dir="rtl">הסר</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>Start-</code></span></td>
<td dir="rtl">התחל</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>Stop-</code></span></td>
<td dir="rtl">עצור</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th dir="rtl">שם עצם</th>
<th dir="rtl">על מה הוא עובד</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl"><span dir="ltr"><code>Process</code></span></td>
<td dir="rtl">תהליך</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>Service</code></span></td>
<td dir="rtl">שירות</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>Item</code></span></td>
<td dir="rtl">קובץ/תיקיה</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>EventLog</code></span></td>
<td dir="rtl">יומני אירועים</td>
</tr>
<tr>
<td dir="rtl"><span dir="ltr"><code>Computer</code></span></td>
<td dir="rtl">מחשב</td>
</tr>
</tbody>
</table>
<h4 dir="rtl">🔄 דוגמאות:</h4>
<table>
<thead>
<tr>
<th dir="rtl">מה לעשות</th>
<th dir="rtl">פקודה</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl">קבל תהליכים</td>
<td dir="rtl"><span dir="ltr"><code>Get-Process</code></span></td>
</tr>
<tr>
<td dir="rtl">עצור שירות</td>
<td dir="rtl"><span dir="ltr"><code>Stop-Service</code></span></td>
</tr>
<tr>
<td dir="rtl">צור קובץ חדש</td>
<td dir="rtl"><span dir="ltr"><code>New-Item</code></span></td>
</tr>
<tr>
<td dir="rtl">קבל תוכן תיקיה</td>
<td dir="rtl"><span dir="ltr"><code>Get-ChildItem</code></span></td>
</tr>
<tr>
<td dir="rtl">הסר קובץ</td>
<td dir="rtl"><span dir="ltr"><code>Remove-Item</code></span></td>
</tr>
</tbody>
</table>
<p dir="rtl">➡ גם אם <strong>אינך יודע את הפקודה המדויקת</strong>, אתה יכול <strong>לנחש</strong> אותה לפי המשמעות — וכמעט תמיד תצדק.</p>
<hr>
<p dir="rtl">ה-cmdlet <span dir="ltr"><code>Get-Help</code></span> הוא העוזר העיקרי שלך.</p>
<ol>
<li dir="rtl"><strong>קבל עזרה על העזרה עצמה:</strong>
<pre class="line-numbers"><code class="language-powershell">    Get-Help Get-Help
</code></pre>
</li>
<li dir="rtl"><strong>קבל עזרה בסיסית על הפקודה לעבודה עם תהליכים:</strong>
<pre class="line-numbers"><code class="language-powershell">    Get-Help Get-Process
</code></pre>
</li>
<li dir="rtl"><strong>ראה דוגמאות לשימוש בפקודה זו:</strong>
<pre class="line-numbers"><code class="language-powershell">    Get-Help Get-Process -Examples
</code></pre>
<p dir="rtl">זהו פרמטר שימושי להפליא שלעתים קרובות נותן פתרונות מוכנים למשימות שלך.</p>
</li>
<li dir="rtl"><strong>קבל את המידע המפורט ביותר על הפקודה:</strong>
<pre class="line-numbers"><code class="language-powershell">    Get-Help Get-Process -Full
</code></pre>
</li>
</ol>
<p dir="rtl">בחלק הבא: הצינור או שרשרת הפקודות (PipeLines)</p>