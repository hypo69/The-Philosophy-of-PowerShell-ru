# בואו נשלב בינה מלאכותית ב-PowerShell

#### **מהו Gemini CLI?**

על **Gemini CLI** כבר סיפרתי בפירוט ב[Gemini CLI: היכרות וצעדים ראשונים](https://pikabu.ru/series/geminicli_48168). אבל אם פספסתם, הנה מבוא קצר.

בקיצור, **Gemini CLI** הוא שורת פקודה לאינטראקציה עם מודלי AI של גוגל. אתה מפעיל אותו בטרמינל שלך, והוא הופך לצ'אט, שבניגוד לגרסאות ווב, יש לו גישה למערכת הקבצים שלך.

**יכולות מפתח:**
*   **מבין קוד:** הוא יכול לנתח את הסקריפטים שלך, למצוא בהם שגיאות ולהציע תיקונים.
*   **מייצר קוד:** אתה יכול לבקש ממנו לכתוב סקריפט PowerShell לפתרון הבעיה שלך, והוא יעשה זאת.
*   **עובד עם קבצים:** יכול לקרוא קבצים, ליצור חדשים, לבצע שינויים בקיימים.
*   **מריץ פקודות:** יכול לבצע פקודות מעטפת, כגון `git` או `npm`.

לצורך מטרותינו, הדבר החשוב ביותר הוא ש-Gemini CLI יודע לעבוד ב**מצב לא אינטראקטיבי**. כלומר, אנו יכולים להעביר לו פרומפט כארגומנט שורת פקודה, והוא פשוט יחזיר לנו תשובה, מבלי להפעיל את הצ'אט האינטראקטיבי שלו. זו בדיוק היכולת שבה נשתמש.

#### **התקנה והגדרה**

כדי להתחיל, עלינו להכין את הסביבה שלנו. זה נעשה פעם אחת.

**שלב 1: התקנת Node.js**
Gemini CLI הוא יישום שנכתב ב-Node.js (סביבה פופולרית עבור JavaScript). לכן, תחילה עלינו להתקין את Node.js עצמו.
1.  עבור לאתר הרשמי: [https://nodejs.org/](https://nodejs.org/)
2.  הורד והתקן את גרסת ה-**LTS**. זוהי האפשרות היציבה והמומלצת ביותר. פשוט עקוב אחר הוראות ההתקנה.
3.  לאחר ההתקנה, פתח חלון PowerShell חדש ובדוק שהכל עובד:
    ```powershell
    node -v
    npm -v
    ```
    אתה אמור לראות גרסאות, לדוגמה, `v20.12.2` ו-`10.5.0`.

**שלב 2: התקנת Gemini CLI עצמו**
כעת, כשיש לנו `npm` (מנהל החבילות של Node.js), התקנת Gemini CLI מסתכמת בפקודה אחת. הפעל אותה ב-PowerShell:
```powershell
npm install -g @google/gemini-cli
```
הדגל `-g` פירושו "התקנה גלובלית", מה שיהפוך את הפקודה `gemini` לזמינה מכל מקום במערכת שלך.

**שלב 3: אימות**
בפעם הראשונה שתפעיל את Gemini CLI, הוא יבקש ממך להיכנס לחשבון Google שלך. זה נחוץ כדי שיוכל להשתמש במכסה החינמית שלך.
1.  פשוט הקלד את הפקודה ב-PowerShell:
    ```powershell
    gemini
    ```
2.  הוא ישאל אותך שאלה לגבי כניסה. בחר "היכנס באמצעות Google".
3.  הדפדפן שלך יפתח חלון כניסה סטנדרטי של Google. היכנס לחשבונך והענק את ההרשאות הנדרשות.
4.  לאחר מכן, תראה הודעת קבלת פנים מ-Gemini בקונסולה. מזל טוב, אתה מוכן לעבודה! תוכל להקליד `/quit` כדי לצאת מהצ'אט שלו.

#### **הפילוסופיה של PowerShell: ה-`Invoke-Expression` הנורא**

לפני שנחבר הכל יחד, בואו נכיר את אחד ה-cmdlets המסוכנים ביותר ב-PowerShell — `Invoke-Expression`, או הכינוי הקצר שלו `iex`.

`Invoke-Expression` לוקח מחרוזת טקסט ומבצע אותה כאילו הייתה פקודה שהוקלדה בקונסולה.

**דוגמה:**
```powershell
$commandString = "Get-Process -Name 'chrome'"
Invoke-Expression -InputObject $commandString
```
פקודה זו תעשה את אותו הדבר כמו קריאה פשוטה ל-`Get-Process -Name 'chrome'`.

**מדוע הוא מסוכן?** מכיוון שביצוע מחרוזת שאינך שולט בה (לדוגמה, שהתקבלה מהאינטרנט או מ-AI), הוא חור אבטחה עצום. אם ה-AI יחזיר בטעות או בזדון את הפקודה `Remove-Item -Path C:\ -Recurse -Force`, `iex` יבצע אותה ללא היסוס.

לצורך משימתנו — יצירת גשר מנוהל ומבוקר בין שאילתת שפה טבעית לביצועה — הוא מתאים באופן מושלם. נשתמש בו בזהירות, מתוך מודעות מלאה לסיכונים.

#### **מחברים הכל יחד: ה-cmdlet `Invoke-Gemini`**
בואו נכתוב פונקציית PowerShell פשוטה שתאפשר לנו לשלוח פרומפטים בפקודה אחת.

העתק קוד זה והדבק אותו בחלון PowerShell שלך כדי שיהיה זמין בסשן הנוכחי.

```powershell
function Invoke-Gemini {
    <#
    .SYNOPSIS
        שולח פרומפט טקסט ל-Gemini CLI ומחזיר את תגובתו.
    #>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true, Position = 0, ValueFromPipeline = $true)]
        [string]$Prompt
    )

    process {
        try {
            # בדוק אם הפקודה gemini זמינה
            $geminiCommand = Get-Command gemini -ErrorAction Stop
        }
        catch {
            Write-Error "הפקודה 'gemini' לא נמצאה. ודא ש-Gemini CLI מותקן."
            return
        }

        Write-Verbose "שולח פרומפט ל-Gemini CLI..."
        
        # הפעל את gemini במצב לא אינטראקטיבי עם הפרומפט שלנו
        $output = & $geminiCommand.Source -p $Prompt 2>&1

        if (-not $?) {
            Write-Warning "הפקודה gemini הסתיימה בשגיאה."
            $output | ForEach-Object { Write-Warning $_.ToString() }
            return
        }

        # החזר פלט נקי
        return $output
    }
}
```

#### **בואו ננסה את הקסם!**


בואו נשאל אותו שאלה כללית ישירות מקונסולת PowerShell שלנו.

```powershell
Invoke-Gemini -Prompt "ספר לי על חמשת הטרנדים האחרונים בתחום למידת מכונה"
```


**מזל טוב!** הרגע הטמעת בהצלחה AI ב-PowerShell.

במאמר הבא אספר לכם כיצד להשתמש ב-Gemini CLI להרצת סקריפטים ואוטומציה של משימות.
