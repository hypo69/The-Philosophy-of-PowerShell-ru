<h2 dir="rtl">הפילוסופיה של PowerShell.</h2>
<h3 dir="rtl">חלק 4: עבודה אינטראקטיבית: <code>Out-ConsoleGridView</code>, התראות.</h3>
<ul>
<li>ב<a href="https://github.com/hypo69/The-Philosophy-of-PowerShell-ru/blob/master/01.md">חלק הראשון</a>, הגדרנו שני מושגי מפתח של PowerShell: הצינור והאובייקט.</li>
<li>ב<a href="https://github.com/hypo69/The-Philosophy-of-PowerShell-ru/blob/master/02.md">חלק השני</a>, הסברתי מהם אובייקטים והצינור.</li>
<li>ב<a href="https://github.com/hypo69/The-Philosophy-of-PowerShell-ru/blob/master/03.md">חלק השלישי</a>, הכרנו את מערכת הקבצים והספקים.</li>
<li>היום נבחן עבודה אינטראקטיבית עם נתונים בקונסולה, וגם נכיר התראות והודעות.</li>
</ul>
<h3 dir="rtl">פרק ראשון: עבודה אינטראקטיבית עם נתונים בקונסולה.</h3>
<h4 dir="rtl"><code>Out-ConsoleGridView</code>. GUI בקונסולת PowerShell.</h4>
<p><strong>❗ חשוב:</strong> כל הכלים המתוארים להלן דורשים <strong>PowerShell 7.2 ואילך</strong>.</p>
<p>Out-ConsoleGridView הוא טבלה אינטראקטיבית, ישירות בקונסולת PowerShell, המאפשרת לך:
- להציג נתונים בפורמט טבלה;
- לסנן ולמיין עמודות;
- לבחור שורות עם הסמן — כדי להעביר אותן הלאה בצינור.
- ועוד הרבה.</p>
<p><code>Out-ConsoleGridView</code> הוא חלק מהמודול <code>Microsoft.PowerShell.ConsoleGuiTools</code>.
כדי להשתמש בו, עליך להתקין תחילה מודול זה.</p>
<p>כדי להתקין את המודול, הפעל את הפקודה הבאה ב-PowerShell:
```powershell
Install-Module Microsoft.PowerShell.ConsoleGuiTools -Scope CurrentUser
```
<img src="assets/04/1.png" alt="Install-Module Microsoft.PowerShell.ConsoleGuiTools -Scope CurrentUser"></p>
<p><em>Install-Module</em> מוריד ומתקין את המודול שצוין מהמאגר למערכת.
מקבילים: `pip install` ב-`Python` או `npm install` ב-`Node.js`.</p>
<p>📎 פרמטרים מרכזיים של <em>Install-Module</em></p>
<hr>
<table>
<thead>
<tr>
<th dir="rtl">פרמטר</th>
<th dir="rtl">תיאור</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="rtl"><code>-Name</code></td>
<td dir="rtl">שם המודול להתקנה.</td>
</tr>
<tr>
<td dir="rtl"><code>-Scope</code></td>
<td dir="rtl">היקף ההתקנה: `AllUsers` (ברירת מחדל, דורש הרשאות מנהל) או `CurrentUser` (אינו דורש הרשאות מנהל).</td>
</tr>
<tr>
<td dir="rtl"><code>-Repository</code></td>
<td dir="rtl">מציין את המאגר, למשל `PSGallery`.</td>
</tr>
<tr>
<td dir="rtl"><code>-Force</code></td>
<td dir="rtl">התקנה כפויה ללא אישור.</td>
</tr>
<tr>
<td dir="rtl"><code>-AllowClobber</code></td>
<td dir="rtl">מאפשר דריסה של פקודות קיימות.</td>
</tr>
<tr>
<td dir="rtl"><code>-AcceptLicense</code></td>
<td dir="rtl">מקבל אוטומטית את רישיון המודול.</td>
</tr>
<tr>
<td dir="rtl"><code>-RequiredVersion</code></td>
<td dir="rtl">מתקין גרסה ספציפית של המודול.</td>
</tr>
</tbody>
</table>
<p>לאחר ההתקנה, תוכל להעביר כל פלט ל-`Out-ConsoleGridView` לעבודה אינטראקטיבית.</p>
<pre class="line-numbers"><code class="language-powershell"># דוגמה קלאסית: הצגת רשימת תהליכים בטבלה אינטראקטיבית
Get-Process | Out-ConsoleGridView
</code></pre>
<p><a href="https://github.com/user-attachments/assets/5828dd51-cfb8-4904-87be-796ccc8395be">1</a></p>
<video width="600" controls>
  <source src="https://github.com/user-attachments/assets/5828dd51-cfb8-4904-87be-796ccc8395be" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p><strong>ממשק:</strong>
*   <strong>סינון:</strong> פשוט התחל להקליד, והרשימה תסונן תוך כדי תנועה.
*   <strong>ניווט:</strong> השתמש במקשי החצים כדי לנוע ברשימה.
*   <strong>בחירה:</strong> הקש `רווח` כדי לבחור/לבטל בחירה של פריט בודד.
*   <strong>בחירה מרובה:</strong> `Ctrl+A` לבחירת כל הפריטים, `Ctrl+D` לביטול כל הבחירות.
*   <strong>אישור:</strong> הקש `Enter` כדי להחזיר את האובייקטים שנבחרו.
*   <strong>ביטול:</strong> הקש `ESC` כדי לסגור את החלון מבלי להחזיר נתונים.</p>
<h2 dir="rtl">מה `Out-ConsoleGridView` יכול לעשות:</h2>
<ul>
<li>להציג נתונים טבלאיים ישירות בקונסולה בצורת טבלה אינטראקטיבית עם ניווט בשורות ובעמודות.</li>
<li>למיין עמודות על ידי לחיצה על מקשים.</li>
<li>לסנן נתונים באמצעות חיפוש.</li>
<li>לבחור שורה אחת או יותר עם החזרת התוצאה.</li>
<li>לעבוד בקונסולה נקייה ללא חלונות GUI.</li>
<li>לתמוך במספר רב של שורות עם גלילה.</li>
<li>לתמוך בסוגי נתונים שונים (מחרוזות, מספרים, תאריכים וכו').</li>
</ul>
<hr>
<h2 dir="rtl">דוגמאות לשימוש ב-`Out-ConsoleGridView`</h2>
<h3 dir="rtl">שימוש בסיסי — הצגת טבלה עם אפשרות לבחירה אינטראקטיבית. (תיבת סימון)</h3>
<pre class="line-numbers"><code class="language-powershell">Import-Module Microsoft.PowerShell.ConsoleGuiTools

$data = Get-Process | Select-Object -First 30 -Property Id, ProcessName, CPU, WorkingSet

# הצג טבלה עם אפשרות לסנן, למיין ולבחור שורות
$selected = $data | Out-ConsoleGridView -Title "Select process(es)" -OutputMode Multiple

$selected | Format-Table -AutoSize
</code></pre>
<p><a href="https://github.com/user-attachments/assets/3f1a2a62-066f-4dbb-947a-9b26095da356">2</a></p>
<video>
  <source src="https://github.com/user-attachments/assets/3f1a2a62-066f-4dbb-947a-9b26095da356" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p>רשימת תהליכים מוצגת בטבלת קונסולה אינטראקטיבית.
ניתן לסנן לפי שם, למיין עמודות ולבחור תהליכים.
התהליכים שנבחרו מוחזרים למשתנה `$selected`.</p>
<hr>
<h3 dir="rtl">בחר שורה אחת עם החזרת תוצאה חובה. (רדיו)</h3>
<pre class="line-numbers"><code class="language-powershell">$choice = Get-Service | Select-Object -First 20 | Out-ConsoleGridView -Title "Select a service" -OutputMode Single

Write-Host "You selected service: $($choice.Name)"
</code></pre>
<p><a href="https://github.com/user-attachments/assets/5ee8fb92-8e18-496a-9db7-2d86b243742e"></a></p>
<video>
  <source src="https://github.com/user-attachments/assets/5ee8fb92-8e18-496a-9db7-2d86b243742e" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p>המשתמש בוחר שורה אחת (שירות). `-OutputMode Single` אוסר על בחירת מספר.</p>
<hr>
<h3 dir="rtl">סינון ומיון של מערכים גדולים</h3>
<pre class="line-numbers"><code class="language-powershell">$data = 1..1000 | ForEach-Object { 
    [PSCustomObject]@{ 
        Number = $_ 
        Square = $_ * $_ 
        Cube   = $_ * $_ * $_ 
    } 
}

$data | Out-ConsoleGridView -Title "Numbers and powers"  -OutputMode Multiple
</code></pre>
<p>מציג טבלה של 1000 שורות עם מספרים וחזקותיהם.</p>
<h3 dir="rtl"><strong>ניהול תהליכים אינטראקטיבי:</strong></h3>
<p>ניתן לבחור מספר תהליכים לעצירה. הפרמטר `-OutputMode Multiple` מציין שאנו רוצים להחזיר את כל הפריטים שנבחרו.</p>
<pre class="line-numbers"><code class="language-powershell"># העבר את התוצאות דרך הצינור.
# עצור את התהליכים שנבחרו עם הפרמטר -WhatIf לתצוגה מקדימה.
# לשם כך, נגדיר את המשתנה $procsToStop
$procsToStop = Get-Process | Out-ConsoleGridView -OutputMode Multiple
    
# אם נבחר משהו, העבר את האובייקטים הלאה בצינור
if ($procsToStop) {
    $procsToStop | Stop-Process -WhatIf
}
</code></pre>
<h3 dir="rtl"><strong>בחירת קבצים לארכוב:</strong></h3>
<p>מצא את כל קבצי ה-`.log` בתיקייה, בחר את אלה הדרושים וצור מהם ארכיון.</p>
<pre class="line-numbers"><code class="language-powershell">$filesToArchive = Get-ChildItem -Path C:\Logs -Filter "*.log" -Recurse | Out-ConsoleGridView -OutputMode Multiple
</code></pre>
<p>❗היזהר עם רקורסיה</p>
<pre class="line-numbers"><code class="language-powershell">if ($filesToArchive) {
    Compress-Archive -Path $filesToArchive.FullName -DestinationPath C:\Temp\LogArchive.zip
    
    # הוסף הודעת הצלחה
    Write-Host "✅ הארכוב הושלם בהצלחה!" -ForegroundColor Green
}
</code></pre>
<h3 dir="rtl"><strong>בחירת פריט בודד לניתוח מפורט:</strong></h3>
<h4 dir="rtl">תבנית ה-"Drill-Down" — מרשימה כללית לפרטים עם `Out-ConsoleGridView`</h4>
<p>לעתים קרובות, כאשר עובדים עם אובייקטים של המערכת, אנו עומדים בפני דילמה:
1.  אם תבקש <strong>את כל המאפיינים</strong> עבור <strong>כל האובייקטים</strong> (`Get-NetAdapter | Format-List *`), הפלט יהיה עצום ובלתי קריא.
2.  אם תציג <strong>טבלה קצרה</strong>, תאבד פרטים חשובים.
3.  לפעמים, ניסיון לקבל את כל הנתונים בבת אחת עלול להוביל לשגיאה אם אחד האובייקטים מכיל ערכים שגויים.</p>
<p>הפתרון לבעיה זו הוא תבנית ה-<strong>"Drill-Down"</strong> (פירוט או "צלילה לעומק"). מהותה פשוטה:</p>
<ul>
<li><strong>שלב 1 (סקירה כללית):</strong> הצג למשתמש רשימה נקייה, תמציתית ובטוחה של פריטים ל<strong>בחירה</strong>.</li>
<li><strong>שלב 2 (פירוט):</strong> לאחר שהמשתמש בחר פריט ספציפי אחד, הצג לו <strong>את כל המידע הזמין</strong> עבור אותו פריט מסוים.</li>
</ul>
<h4 dir="rtl">דוגמה מעשית: יצירת סייר מתאמי רשת</h4>
<p>בואו ניישם תבנית זו באמצעות הפקודה `Get-NetAdapter` כדוגמה.</p>
<p><strong>משימה:</strong> תחילה, הצג רשימה קצרה של מתאמי רשת. לאחר בחירת אחד מהם, פתח חלון שני עם כל מאפייניו.</p>
<p><strong>קוד מוכן:</strong>
```powershell
# --- שלב 1: בחירת מתאם מרשימה קצרה ---
$adapterList = Get-NetAdapter | Select-Object Name, InterfaceDescription, Status, LinkSpeed
$selectedAdapter = $adapterList | Out-ConsoleGridView -Title "שלב 1: בחר מתאם רשת"

# --- שלב 2: הצגת מידע מפורט או הודעת ביטול ---
if ($null -ne $selectedAdapter) {
    # קבל את כל המאפיינים עבור המתאם הנבחר
    $detailedInfoObject = Get-NetAdapter -Name $selectedAdapter.Name | Select-Object *

    # השתמש בטריק שלנו עם .psobject.Properties כדי להפוך את האובייקט לטבלת "שם-ערך" נוחה
    $detailedInfoForGrid = $detailedInfoObject.psobject.Properties | Select-Object Name, Value
    
    # פתח חלון GridView שני עם מידע מלא
    $detailedInfoForGrid | Out-ConsoleGridView -Title "שלב 2: מידע מלא עבור '$($selectedAdapter.Name)'"
} else {
    Write-Host "הפעולה בוטלה. לא נבחר מתאם." -ForegroundColor Yellow
}
```</p>
<h4 dir="rtl">פירוט שלב אחר שלב</h4>
<ol>
<li>
<p><strong>יצירת רשימה "בטוחה":</strong>
`$adapterList = Get-NetAdapter | Select-Object Name, InterfaceDescription, Status, LinkSpeed`
איננו מעבירים את הפלט של `Get-NetAdapter` ישירות. במקום זאת, אנו יוצרים אובייקטים חדשים ו"נקיים" באמצעות `Select-Object`, כולל רק את המאפיינים שאנו צריכים לסקירה הכללית. זה מבטיח שנתונים בעייתיים שגרמו לשגיאה יימחקו.</p>
</li>
<li>
<p><strong>חלון אינטראקטיבי ראשון:</strong>
`$selectedAdapter = $adapterList | Out-ConsoleGridView ...`
הסקריפט מציג את החלון הראשון ו<strong>עוצר את ביצועו</strong>, ממתין לבחירתך. ברגע שתבחר שורה ותלחץ על `Enter`, האובייקט המתאים לשורה זו ייכתב למשתנה `$selectedAdapter`.</p>
</li>
<li>
<p><strong>בדיקת הבחירה:</strong>
`if ($null -ne $selectedAdapter)`
זוהי בדיקה קריטית. אם המשתמש ילחץ על `Esc` או יסגור את החלון, המשתנה `$selectedAdapter` יהיה ריק (`$null`). בדיקה זו מונעת את ביצוע שאר הקוד והופעת שגיאות.</p>
</li>
<li>
<p><strong>קבלת מידע מלא:</strong>
`$detailedInfoObject = Get-NetAdapter -Name $selectedAdapter.Name`
זהו הנקודה המרכזית של התבנית. אנו ניגשים שוב ל-`Get-NetAdapter`, אך הפעם אנו מבקשים <strong>רק אובייקט אחד</strong> לפי שמו, שלקחנו מהפריט שנבחר בשלב הראשון. כעת אנו מקבלים את האובייקט המלא עם כל מאפייניו.</p>
</li>
<li>
<p><strong>המרת לחלון השני:</strong>
`$detailedInfoForGrid = $detailedInfoObject.psobject.Properties | ...`
אנו משתמשים בטכניקה החזקה שאתה כבר מכיר כדי "להרחיב" את האובייקט המורכב הזה לרשימה ארוכה של זוגות "שם מאפיין" | "ערך", שהיא אידיאלית להצגה בטבלה.</p>
</li>
<li>
<p><strong>חלון אינטראקטיבי שני:</strong>
`$detailedInfoForGrid | Out-ConsoleGridView ...`
חלון שני מופיע על המסך, הפעם עם מידע מקיף על אותו מתאם שבחרת.</p>
</li>
</ol>
<hr>
<h3 dir="rtl">דוגמה עם כותרת ורמזים מותאמים אישית</h3>
<p>הצגת יומן האירועים של Windows בטבלה אינטראקטיבית עם הכותרת "אירועי מערכת".</p>
<pre class="line-numbers"><code class="language-powershell">Get-EventLog -LogName System -Newest 50 |
    Select-Object TimeGenerated, EntryType, Source, Message |
    Out-ConsoleGridView -Title "System Events"  -OutputMode Multiple
</code></pre>
<p>קוד זה מקבל את 50 האירועים האחרונים מיומן המערכת של Windows, בוחר רק ארבעה מאפיינים מרכזיים מכל אירוע
(זמן, סוג, מקור והודעה) ומציג אותם בחלון Out-ConsoleGridView.</p>
<hr>
<h3 dir="rtl">מידע מערכת.</h3>
<p><a href="https://github.com/user-attachments/assets/1e53a339-56f9-4add-8053-86d94dbc8e06">1</a></p>
<video width="600" controls>
  <source src="https://github.com/user-attachments/assets/1e53a339-56f9-4add-8053-86d94dbc8e06" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p>קוד סקריפט לקבלת מידע מערכת:
<a href="https://github.com/hypo69/The-Philosophy-of-PowerShell-ru/blob/master/code/04/Get-SystemMonitor.ps1">Get-SystemMonitor.ps1</a></p>
<h3 dir="rtl">יצירת ה-cmdlet 'Get-SystemMonitor'</h3>
<h4 dir="rtl">שלב 1: הגדרת המשתנה `PATH`</h4>
<ol>
<li>
<p><strong>צור תיקייה קבועה לכלים שלך,</strong> אם עדיין לא עשית זאת. לדוגמה:
`C:\PowerShell\Scripts`</p>
</li>
<li>
<p><strong>הצב את קובץ `Get-SystemMonitor.ps1` שלך</strong> בתיקייה זו.</p>
</li>
<li>
<p><strong>הוסף תיקייה זו למשתנה המערכת `PATH`</strong>,</p>
</li>
</ol>
<h4 dir="rtl">שלב 2: הגדרת כינוי בפרופיל PowerShell</h4>
<p>כעת, כשהמערכת יודעת היכן למצוא את הסקריפט שלך בשמו המלא, אנו יכולים ליצור לו כינוי קצר.</p>
<ol>
<li>
<p><strong>פתח את קובץ הפרופיל שלך ב-PowerShell</strong>:
```powershell
notepad $PROFILE
```</p>
</li>
<li>
<p><strong>הוסף אליו את השורה הבאה:</strong>
```powershell
# כינוי למפקח המערכת
Set-Alias -Name sysmon -Value "Get-SystemMonitor.ps1"
```</p>
<p><strong>שים לב לנקודה המרכזית:</strong> מכיוון שהתיקייה עם הסקריפט כבר נמצאת ב-`PATH`, <strong>איננו צריכים עוד לציין את הנתיב המלא</strong> לקובץ! אנו פשוט מתייחסים לשמו. זה הופך את הפרופיל שלך לנקי ואמין יותר. אם אי פעם תעביר את התיקייה `C:\PowerShell\Scripts`, תצטרך לעדכן רק את המשתנה `PATH`, וקובץ הפרופיל שלך יישאר ללא שינוי.</p>
</li>
</ol>
<h4 dir="rtl">הפעל מחדש את PowerShell</h4>
<p>סגור <strong>את כל</strong> חלונות PowerShell הפתוחים ופתח חלון חדש. זה הכרחי כדי שהמערכת תחיל את השינויים הן במשתנה `PATH` והן בפרופיל שלך.</p>
<hr>
<h3 dir="rtl">סיכום: מה אתה מקבל</h3>
<p>לאחר השלמת שלבים אלה, תוכל לקרוא לסקריפט שלך <strong>בשתי דרכים מכל מקום במערכת</strong>:</p>
<ol>
<li>
<p><strong>בשם מלא (אמין, לשימוש בסקריפטים אחרים):</strong>
```powershell
Get-SystemMonitor.ps1
Get-SystemMonitor.ps1 -Resource storage
```</p>
</li>
<li>
<p><strong>בכינוי קצר (נוח, לעבודה אינטראקטיבית):</strong>
```powershell
sysmon
sysmon -Resource memory
```</p>
</li>
</ol>
<p>"רשמת" בהצלחה את הסקריפט שלך במערכת בצורה המקצועית והגמישה ביותר.</p>
<p>מועיל? הירשם.
אהבת — תן "+"
בהצלחה! 🚀</p>
<p>מאמרים אחרים על PowerShell:</p>
