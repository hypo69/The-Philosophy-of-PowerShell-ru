<h2>La filosof√≠a de PowerShell.</h2>
<h3>Parte 4: Trabajo interactivo: <code>Out-ConsoleGridView</code>, alertas.</h3>
<ul>
<li>En <a href="https://github.com/hypo69/The-Philosophy-of-PowerShell-ru/blob/master/01.md">la primera parte</a>, definimos dos conceptos clave de PowerShell: la canalizaci√≥n y el objeto.</li>
<li>En <a href="https://github.com/hypo69/The-Philosophy-of-PowerShell-ru/blob/master/02.md">la segunda parte</a>, expliqu√© qu√© son los objetos y la canalizaci√≥n.</li>
<li>En <a href="https://github.com/hypo69/The-Philosophy-of-PowerShell-ru/blob/master/03.md">la tercera parte</a>, nos familiarizamos con el sistema de archivos y los proveedores.</li>
<li>Hoy veremos el trabajo interactivo con datos en la consola, y tambi√©n nos familiarizaremos con las alertas y notificaciones.</li>
</ul>
<h3>Cap√≠tulo uno: Trabajo interactivo con datos en la consola.</h3>
<h4><code>Out-ConsoleGridView</code>. GUI en la consola de PowerShell.</h4>
<p><strong>‚ùó Importante:</strong> todas las herramientas que se describen a continuaci√≥n requieren <strong>PowerShell 7.2 o posterior</strong>.</p>
<p>Out-ConsoleGridView es una tabla interactiva, directamente en la consola de PowerShell, que le permite:
- ver datos en formato de tabla;
- filtrar y ordenar columnas;
- seleccionar filas con el cursor ‚Äî para pasarlas m√°s adelante en la canalizaci√≥n.
- y mucho m√°s.</p>
<p><code>Out-ConsoleGridView</code> forma parte del m√≥dulo <code>Microsoft.PowerShell.ConsoleGuiTools</code>.
Para usarlo, primero debe instalar este m√≥dulo.</p>
<p>Para instalar el m√≥dulo, ejecute el siguiente comando en PowerShell:
```powershell
Install-Module Microsoft.PowerShell.ConsoleGuiTools -Scope CurrentUser
```
<img src="assets/04/1.png" alt="Install-Module Microsoft.PowerShell.ConsoleGuiTools -Scope CurrentUser"></p>
<p><em>Install-Module</em> descarga e instala el m√≥dulo especificado desde el repositorio en el sistema.
An√°logos: `pip install` en `Python` o `npm install` en `Node.js`.</p>
<p>üìé Par√°metros clave de <em>Install-Module</em></p>
<hr>
<table>
<thead>
<tr>
<th>Par√°metro</th>
<th>Descripci√≥n</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-Name</code></td>
<td>El nombre del m√≥dulo que se va a instalar.</td>
</tr>
<tr>
<td><code>-Scope</code></td>
<td>El √°mbito de la instalaci√≥n: `AllUsers` (predeterminado, requiere derechos de administrador) o `CurrentUser` (no requiere derechos de administrador).</td>
</tr>
<tr>
<td><code>-Repository</code></td>
<td>Especifica el repositorio, por ejemplo `PSGallery`.</td>
</tr>
<tr>
<td><code>-Force</code></td>
<td>Instalaci√≥n forzada sin confirmaci√≥n.</td>
</tr>
<tr>
<td><code>-AllowClobber</code></td>
<td>Permite sobrescribir los comandos existentes.</td>
</tr>
<tr>
<td><code>-AcceptLicense</code></td>
<td>Acepta autom√°ticamente la licencia del m√≥dulo.</td>
</tr>
<tr>
<td><code>-RequiredVersion</code></td>
<td>Instala una versi√≥n espec√≠fica del m√≥dulo.</td>
</tr>
</tbody>
</table>
<p>Despu√©s de la instalaci√≥n, puede pasar cualquier salida a `Out-ConsoleGridView` para un trabajo interactivo.</p>
<pre class="line-numbers"><code class="language-powershell"># Ejemplo cl√°sico: mostrar una lista de procesos en una tabla interactiva
Get-Process | Out-ConsoleGridView
</code></pre>
<p><a href="https://github.com/user-attachments/assets/5828dd51-cfb8-4904-87be-796ccc8395be">1</a></p>
<video width="600" controls>
  <source src="https://github.com/user-attachments/assets/5828dd51-cfb8-4904-87be-796ccc8395be" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p><strong>Interfaz:</strong>
*   <strong>Filtrado:</strong> simplemente comience a escribir y la lista se filtrar√° sobre la marcha.
*   <strong>Navegaci√≥n:</strong> use las teclas de flecha para moverse por la lista.
*   <strong>Selecci√≥n:</strong> presione `Espacio` para seleccionar/deseleccionar un solo elemento.
*   <strong>Selecci√≥n m√∫ltiple:</strong> `Ctrl+A` para seleccionar todos los elementos, `Ctrl+D` para deseleccionar todo.
*   <strong>Confirmaci√≥n:</strong> presione `Intro` para devolver los objetos seleccionados.
*   <strong>Cancelaci√≥n:</strong> presione `ESC` para cerrar la ventana sin devolver datos.</p>
<h2>Qu√© puede hacer `Out-ConsoleGridView`:</h2>
<ul>
<li>Mostrar datos tabulares directamente en la consola en forma de una tabla interactiva con navegaci√≥n por filas y columnas.</li>
<li>Ordenar columnas presionando teclas.</li>
<li>Filtrar datos mediante la b√∫squeda.</li>
<li>Seleccionar una o m√°s filas con el resultado devuelto.</li>
<li>Trabajar en una consola limpia sin ventanas de GUI.</li>
<li>Admitir una gran cantidad de filas con desplazamiento.</li>
<li>Admitir varios tipos de datos (cadenas, n√∫meros, fechas, etc.).</li>
</ul>
<hr>
<h2>Ejemplos de uso de `Out-ConsoleGridView`</h2>
<h3>Uso b√°sico: mostrar una tabla con la capacidad de seleccionar de forma interactiva. (casilla de verificaci√≥n)</h3>
<pre class="line-numbers"><code class="language-powershell">Import-Module Microsoft.PowerShell.ConsoleGuiTools

$data = Get-Process | Select-Object -First 30 -Property Id, ProcessName, CPU, WorkingSet

# Mostrar una tabla con la capacidad de filtrar, ordenar y seleccionar filas
$selected = $data | Out-ConsoleGridView -Title "Select process(es)" -OutputMode Multiple

$selected | Format-Table -AutoSize
</code></pre>
<p><a href="https://github.com/user-attachments/assets/3f1a2a62-066f-4dbb-947a-9b26095da356">2</a></p>
<video>
  <source src="https://github.com/user-attachments/assets/3f1a2a62-066f-4dbb-947a-9b26095da356" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p>Se muestra una lista de procesos en una tabla de consola interactiva.
Puede filtrar por nombre, ordenar columnas y seleccionar procesos.
Los procesos seleccionados se devuelven a la variable `$selected`.</p>
<hr>
<h3>Seleccionar una fila con devoluci√≥n de resultado obligatoria. (radio)</h3>
<pre class="line-numbers"><code class="language-powershell">$choice = Get-Service | Select-Object -First 20 | Out-ConsoleGridView -Title "Select a service" -OutputMode Single

Write-Host "You selected service: $($choice.Name)"
</code></pre>
<p><a href="https://github.com/user-attachments/assets/5ee8fb92-8e18-496a-9db7-2d86b243742e"></a></p>
<video>
  <source src="https://github.com/user-attachments/assets/5ee8fb92-8e18-496a-9db7-2d86b243742e" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p>El usuario selecciona una fila (servicio). `-OutputMode Single` proh√≠be seleccionar varias.</p>
<hr>
<h3>Filtrado y ordenaci√≥n de matrices grandes</h3>
<pre class="line-numbers"><code class="language-powershell">$data = 1..1000 | ForEach-Object { 
    [PSCustomObject]@{ 
        Number = $_ 
        Square = $_ * $_ 
        Cube   = $_ * $_ * $_ 
    } 
}

$data | Out-ConsoleGridView -Title "Numbers and powers"  -OutputMode Multiple
</code></pre>
<p>Muestra una tabla de 1000 filas con n√∫meros y sus potencias.</p>
<h3><strong>Administraci√≥n interactiva de procesos:</strong></h3>
<p>Puede seleccionar varios procesos para detenerlos. El par√°metro `-OutputMode Multiple` indica que queremos devolver todos los elementos seleccionados.</p>
<pre class="line-numbers"><code class="language-powershell"># Pasar los resultados a trav√©s de la canalizaci√≥n.
# Detener los procesos seleccionados con el par√°metro -WhatIf para una vista previa.
# Para ello, definiremos la variable $procsToStop
$procsToStop = Get-Process | Out-ConsoleGridView -OutputMode Multiple
    
# Si se seleccion√≥ algo, pasar los objetos m√°s adelante en la canalizaci√≥n
if ($procsToStop) {
    $procsToStop | Stop-Process -WhatIf
}
</code></pre>
<h3><strong>Selecci√≥n de archivos para archivar:</strong></h3>
<p>Buscar todos los archivos `.log` en una carpeta, seleccionar los necesarios y crear un archivo a partir de ellos.</p>
<pre class="line-numbers"><code class="language-powershell">$filesToArchive = Get-ChildItem -Path C:\Logs -Filter "*.log" -Recurse | Out-ConsoleGridView -OutputMode Multiple
</code></pre>
<p>‚ùóTenga cuidado con la recursividad</p>
<pre class="line-numbers"><code class="language-powershell">if ($filesToArchive) {
    Compress-Archive -Path $filesToArchive.FullName -DestinationPath C:\Temp\LogArchive.zip
    
    # Agregar un mensaje de √©xito
    Write-Host "‚úÖ ¬°El archivado se complet√≥ correctamente!" -ForegroundColor Green
}
</code></pre>
<h3><strong>Selecci√≥n de un solo elemento para un an√°lisis detallado:</strong></h3>
<h4>El patr√≥n "Drill-Down": de una lista general a los detalles con `Out-ConsoleGridView`</h4>
<p>A menudo, cuando se trabaja con objetos del sistema, nos enfrentamos a un dilema:
1.  Si solicita <strong>todas las propiedades</strong> para <strong>todos los objetos</strong> (`Get-NetAdapter | Format-List *`), la salida ser√° enorme e ilegible.
2.  Si muestra una <strong>tabla corta</strong>, perder√° detalles importantes.
3.  A veces, intentar obtener todos los datos a la vez puede provocar un error si uno de los objetos contiene valores incorrectos.</p>
<p>La soluci√≥n a este problema es el patr√≥n <strong>"Drill-Down"</strong> (profundizaci√≥n). Su esencia es simple:</p>
<ul>
<li><strong>Paso 1 (Descripci√≥n general):</strong> mostrar al usuario una lista de elementos limpia, concisa y segura para la <strong>selecci√≥n</strong>.</li>
<li><strong>Paso 2 (Profundizaci√≥n):</strong> despu√©s de que el usuario haya seleccionado un elemento espec√≠fico, mostrarle <strong>toda la informaci√≥n disponible</strong> para ese elemento en particular.</li>
</ul>
<h4>Ejemplo pr√°ctico: creaci√≥n de un explorador de adaptadores de red</h4>
<p>Implementemos este patr√≥n usando el comando `Get-NetAdapter` como ejemplo.</p>
<p><strong>Tarea:</strong> primero, mostrar una lista corta de adaptadores de red. Despu√©s de seleccionar uno de ellos, abrir una segunda ventana con todas sus propiedades.</p>
<p><strong>C√≥digo listo para usar:</strong>
```powershell
# --- Etapa 1: selecci√≥n de un adaptador de una lista corta ---
$adapterList = Get-NetAdapter | Select-Object Name, InterfaceDescription, Status, LinkSpeed
$selectedAdapter = $adapterList | Out-ConsoleGridView -Title "ETAPA 1: seleccione un adaptador de red"

# --- Etapa 2: mostrar informaci√≥n detallada o un mensaje de cancelaci√≥n ---
if ($null -ne $selectedAdapter) {
    # Obtener TODAS las propiedades del adaptador SELECCIONADO
    $detailedInfoObject = Get-NetAdapter -Name $selectedAdapter.Name | Select-Object *

    # Usar nuestro truco con .psobject.Properties para convertir el objeto en una tabla "Nombre-Valor" conveniente
    $detailedInfoForGrid = $detailedInfoObject.psobject.Properties | Select-Object Name, Value
    
    # Abrir una SEGUNDA ventana de GridView con informaci√≥n completa
    $detailedInfoForGrid | Out-ConsoleGridView -Title "ETAPA 2: informaci√≥n completa para '$($selectedAdapter.Name)'"
} else {
    Write-Host "Operaci√≥n cancelada. No se seleccion√≥ ning√∫n adaptador." -ForegroundColor Yellow
}
```</p>
<h4>An√°lisis paso a paso</h4>
<ol>
<li>
<p><strong>Creaci√≥n de una lista "segura":</strong>
`$adapterList = Get-NetAdapter | Select-Object Name, InterfaceDescription, Status, LinkSpeed`
No estamos pasando la salida de `Get-NetAdapter` directamente. En su lugar, estamos creando nuevos objetos "limpios" usando `Select-Object`, incluyendo solo las propiedades que necesitamos para la descripci√≥n general. Esto garantiza que los datos problem√°ticos que causaron un error se descarten.</p>
</li>
<li>
<p><strong>Primera ventana interactiva:</strong>
`$selectedAdapter = $adapterList | Out-ConsoleGridView ...`
El script muestra la primera ventana y <strong>detiene su ejecuci√≥n</strong>, esperando su elecci√≥n. Tan pronto como seleccione una fila y presione `Intro`, el objeto correspondiente a esa fila se escribir√° en la variable `$selectedAdapter`.</p>
</li>
<li>
<p><strong>Comprobaci√≥n de la selecci√≥n:</strong>
`if ($null -ne $selectedAdapter)`
Esta es una comprobaci√≥n de importancia cr√≠tica. Si el usuario presiona `Esc` o cierra la ventana, la variable `$selectedAdapter` estar√° vac√≠a (`$null`). Esta comprobaci√≥n evita que se ejecute el resto del c√≥digo y que se produzcan errores.</p>
</li>
<li>
<p><strong>Obtenci√≥n de informaci√≥n completa:</strong>
`$detailedInfoObject = Get-NetAdapter -Name $selectedAdapter.Name`
Este es el punto clave del patr√≥n. Estamos accediendo de nuevo a `Get-NetAdapter`, pero esta vez estamos solicitando <strong>solo un</strong> objeto por su nombre, que tomamos del elemento seleccionado en la primera etapa. Ahora obtenemos el objeto completo con todas sus propiedades.</p>
</li>
<li>
<p><strong>Conversi√≥n para la segunda ventana:</strong>
`$detailedInfoForGrid = $detailedInfoObject.psobject.Properties | ...`
Utilizamos la potente t√©cnica que ya conoce para "expandir" este objeto complejo en una larga lista de pares "Nombre de propiedad" | "Valor", que es ideal para mostrar en una tabla.</p>
</li>
<li>
<p><strong>Segunda ventana interactiva:</strong>
`$detailedInfoForGrid | Out-ConsoleGridView ...`
Aparece una segunda ventana en la pantalla, esta vez con informaci√≥n completa sobre el mismo adaptador que seleccion√≥.</p>
</li>
</ol>
<hr>
<h3>Ejemplo con un t√≠tulo y sugerencias personalizados</h3>
<p>Mostrar el registro de eventos de Windows en una tabla interactiva con el t√≠tulo "Eventos del sistema".</p>
<pre class="line-numbers"><code class="language-powershell">Get-EventLog -LogName System -Newest 50 |
    Select-Object TimeGenerated, EntryType, Source, Message |
    Out-ConsoleGridView -Title "System Events"  -OutputMode Multiple
</code></pre>
<p>Este c√≥digo obtiene los 50 eventos m√°s recientes del registro del sistema de Windows, selecciona solo cuatro propiedades clave de cada evento
(hora, tipo, origen y mensaje) y los muestra en la ventana de Out-ConsoleGridView.</p>
<hr>
<h3>Informaci√≥n del sistema.</h3>
<p><a href="https://github.com/user-attachments/assets/1e53a339-56f9-4add-8053-86d94dbc8e06">1</a></p>
<video width="600" controls>
  <source src="https://github.com/user-attachments/assets/1e53a339-56f9-4add-8053-86d94dbc8e06" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p>c√≥digo de script para obtener informaci√≥n del sistema:
<a href="https://github.com/hypo69/The-Philosophy-of-PowerShell-ru/blob/master/code/04/Get-SystemMonitor.ps1">Get-SystemMonitor.ps1</a></p>
<h3>Creaci√≥n del cmdlet 'Get-SystemMonitor'</h3>
<h4>Paso 1: configuraci√≥n de la variable `PATH`</h4>
<ol>
<li>
<p><strong>Cree una carpeta permanente para sus herramientas,</strong> si a√∫n no lo ha hecho. Por ejemplo:
`C:\PowerShell\Scripts`</p>
</li>
<li>
<p><strong>Coloque su archivo `Get-SystemMonitor.ps1`</strong> en esta carpeta.</p>
</li>
<li>
<p><strong>Agregue esta carpeta a la variable del sistema `PATH`</strong>,</p>
</li>
</ol>
<h4>Paso 2: configuraci√≥n de un alias en el perfil de PowerShell</h4>
<p>Ahora que el sistema sabe d√≥nde encontrar su script por su nombre completo, podemos crear un alias corto para √©l.</p>
<ol>
<li>
<p><strong>Abra su archivo de perfil de PowerShell</strong>:
```powershell
notepad $PROFILE
```</p>
</li>
<li>
<p><strong>Agr√©guele la siguiente l√≠nea:</strong>
```powershell
# Alias para el monitor del sistema
Set-Alias -Name sysmon -Value "Get-SystemMonitor.ps1"
```</p>
<p><strong>Preste atenci√≥n al punto clave:</strong> como la carpeta con el script ya est√° en la `PATH`, ¬°ya <strong>no necesitamos especificar la ruta completa</strong> al archivo! Simplemente nos referimos a su nombre. Esto hace que su perfil sea m√°s limpio y confiable. Si alguna vez mueve la carpeta `C:\PowerShell\Scripts`, solo necesitar√° actualizar la variable `PATH`, y su archivo de perfil permanecer√° sin cambios.</p>
</li>
</ol>
<h4>Reinicie PowerShell</h4>
<p>Cierre <strong>todas</strong> las ventanas de PowerShell abiertas y abra una nueva. Esto es necesario para que el sistema aplique los cambios tanto a la variable `PATH` como a su perfil.</p>
<hr>
<h3>Resumen: lo que obtiene</h3>
<p>Despu√©s de completar estos pasos, podr√° llamar a su script <strong>de dos maneras desde cualquier lugar del sistema</strong>:</p>
<ol>
<li>
<p><strong>Por nombre completo (confiable, para usar en otros scripts):</strong>
```powershell
Get-SystemMonitor.ps1
Get-SystemMonitor.ps1 -Resource storage
```</p>
</li>
<li>
<p><strong>Por alias corto (conveniente, para trabajo interactivo):</strong>
```powershell
sysmon
sysmon -Resource memory
```</p>
</li>
</ol>
<p>Ha "registrado" correctamente su script en el sistema de la manera m√°s profesional y flexible.</p>
<p>¬ø√ötil? Suscr√≠base.
¬øLe gust√≥? ‚Äî d√© un "+"
¬°Buena suerte! üöÄ</p>
<p>Otros art√≠culos sobre PowerShell:</p>
