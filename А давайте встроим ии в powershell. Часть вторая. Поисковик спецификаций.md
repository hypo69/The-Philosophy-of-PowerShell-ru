# –ê –¥–∞–≤–∞–π—Ç–µ –≤—Å—Ç—Ä–æ–∏–º –∏–∏ –≤ powershell. –ß–∞—Å—Ç—å –≤—Ç–æ—Ä–∞—è. –ü–æ–∏—Å–∫–æ–≤–∏–∫ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π

–í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –º—ã —É–≤–∏–¥–µ–ª–∏, –∫–∞–∫ —Å –ø–æ–º–æ—â—å—é powershell –º–æ–∂–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –º–æ–¥–µ–ª—å—é Gemini —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —è –ø–æ–∫–∞–∂—É –∫–∞–∫ –∏–∑–≤–ª–µ—á—å –ø–æ–ª—å–∑—É –∏–∑ –Ω–∞—à–∏—Ö –∑–Ω–∞–Ω–∏–π. –ú—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏–º –Ω–∞—à—É –∫–æ–Ω—Å–æ–ª—å –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –≤—Ö–æ–¥ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–º–∞—Ä–∫–∞, –º–æ–¥–µ–ª—å, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∞—Ä—Ç–∏–∫—É–ª –∏ —Ç. –ø.), –∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏, –ø–æ–ª—É—á–µ–Ω–Ω—É—é –æ—Ç –º–æ–¥–µ–ª–∏ Gemini.

–ò–Ω–∂–µ–Ω–µ—Ä—ã, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –¥—Ä—É–≥–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å —Ç–µ–º, —á—Ç–æ –Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —Ç–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–æ–π –ø–ª–∞—Ç—ã, –∞–≤—Ç–æ–º–∞—Ç–∞ –≤ —ç–ª–µ–∫—Ç—Ä–æ—â–∏—Ç–∫–µ –∏–ª–∏ —Å–µ—Ç–µ–≤–æ–≥–æ –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä–∞. –ù–∞—à —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–¥ —Ä—É–∫–æ–π –∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É —Å–æ–±–µ—Ä–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —É—Ç–æ—á–Ω–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∏ –≤–µ—Ä–Ω–µ—Ç –∏—Å–∫–æ–º—É—é —Ç–∞–±–ª–∏—Ü—É. –í —Ç–∞–±–ª–∏—Ü–µ –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä/—ã –∏ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —É–≥–ª—É–±–ª–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫. –í –¥–∞–ª—å–Ω–µ–π—à–µ–º –º—ã –Ω–∞—É—á–∏–º—Å—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –∫–æ–Ω–≤–µ–π–µ—Ä—É –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏: —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ —Ç–∞–±–ª–∏—Ü—É Excel, Google —Ç–∞–±–ª–∏—Ü—É, —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –¥—Ä—É–≥—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É  –í —Å–ª—É—á–∞–µ –Ω–µ—É–¥–∞—á–∏ –º–æ–¥–µ–ª—å –ø–æ—Å–æ–≤–µ—Ç—É–µ—Ç, –∫–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–¥–æ —É—Ç–æ—á–Ω–∏—Ç—å. –í–ø—Ä–æ—á–µ–º, —Å–º–æ—Ç—Ä–∏—Ç–µ —Å–∞–º–∏:

[video](https://github.com/user-attachments/assets/0e6690c1-5d49-4c75-89fc-ede2c7642c5f)

<video width="600" controls>
  <source src="https://github.com/user-attachments/assets/0e6690c1-5d49-4c75-89fc-ede2c7642c5f" type="video/mp4">
  Your browser does not support the video tag.
</video>

```powershell
# --- –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ---
$env:GEMINI_API_KEY = "AIzaSyCbq8bkt5Xr2hlE-73MIXFpdFYH-rLBd0k"
if (-not $env:GEMINI_API_KEY) { Write-Error "..."; return }

$scriptRoot = Get-Location
# --- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞ ---
$HistoryDir = Join-Path $scriptRoot ".gemini/.chat_history"
# --- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø ---
$timestamp = Get-Date -Format "yyyy-MM-dd_HH-mm-ss"
$historyFileName = "ai_session_$timestamp.jsonl"
$historyFilePath = Join-Path $HistoryDir $historyFileName


# --- –§–£–ù–ö–¶–ò–ò ---
function Add-History { 
    param([string]$UserPrompt, [string]$ModelResponse)
    # --- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π ---
    if (-not (Test-Path $HistoryDir)) { New-Item -Path $HistoryDir -ItemType Directory | Out-Null }
    # --- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø ---
    @{ user = $UserPrompt } | ConvertTo-Json -Compress | Add-Content -Path $historyFilePath
    @{ model = $ModelResponse } | ConvertTo-Json -Compress | Add-Content -Path $historyFilePath
}

function Show-History {
    if (-not (Test-Path $historyFilePath)) { Write-Host "–ò—Å—Ç–æ—Ä–∏—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ –ø—É—Å—Ç–∞." -ForegroundColor Yellow; return }
    Write-Host "`n--- –ò—Å—Ç–æ—Ä–∏—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ ---" -ForegroundColor Cyan; Get-Content -Path $historyFilePath; Write-Host "------------------------------------`n" -ForegroundColor Cyan
}

function Clear-History {
    if (Test-Path $historyFilePath) {
        try {
            Remove-Item -Path $historyFilePath -Force -ErrorAction Stop
            Write-Host "–ò—Å—Ç–æ—Ä–∏—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ ($historyFileName) –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞." -ForegroundColor Yellow
        }
        catch { Write-Warning "–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –∏—Å—Ç–æ—Ä–∏–∏: $_" }
    }
    else { Write-Host "–ò—Å—Ç–æ—Ä–∏—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ –ø—É—Å—Ç–∞, —É–¥–∞–ª—è—Ç—å –Ω–µ—á–µ–≥–æ." -ForegroundColor Yellow }
}

function Show-Help {
    $helpFilePath = Join-Path $scriptRoot ".gemini/ShowHelp.md"
    if (Test-Path $helpFilePath) {
        $helpText = Get-Content -Path $helpFilePath -Raw
        Write-Host $helpText
    }
    else {
        Write-Warning "–§–∞–π–ª —Å–ø—Ä–∞–≤–∫–∏ .gemini/ShowHelp.md –Ω–µ –Ω–∞–π–¥–µ–Ω."
    }
}

function Command-Handler {
    param([string]$Command)

    switch ($Command) {
        '?' { Show-Help; return 'continue' }
        'history' { Show-History; return 'continue' }
        ('clear', 'clear-history') { Clear-History; return 'continue' }
        'gemini help' {
            Write-Host "`n--- –°–ø—Ä–∞–≤–∫–∞ Gemini CLI ---`n" -ForegroundColor Cyan
            & gemini --help
            Write-Host "`n--------------------------`n" -ForegroundColor Cyan
            return 'continue'
        }
        ('exit', 'quit') { return 'break' }
        default {
            return $null
        }
    }
}

function Invoke-GeminiPrompt {
    param([string]$Prompt, [string]$Model)
    try {
        $output = & gemini -m $Model -p $Prompt 2>&1
        if (-not $?) { $output | ForEach-Object { Write-Warning $_.ToString() }; return $null }
        $outputString = ($output -join [Environment]::NewLine).Trim()
        $cleanedOutput = $outputString -replace "(?m)^Data collection is disabled\.`r?`n" , ""
        $cleanedOutput = $cleanedOutput -replace "(?m)^Loaded cached credentials\.`r?`n", ""
        return $cleanedOutput.Trim()
    }
    catch { Write-Error "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ Gemini CLI: $_"; return $null }
}

# --- –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ ---
function Show-SelectionTable {
    param([array]$SelectedData)
    
    if ($null -eq $SelectedData -or $SelectedData.Count -eq 0) {
        return
    }
    
    Write-Host "`n--- –í–´–ë–†–ê–ù–ù–´–ï –î–ê–ù–ù–´–ï ---" -ForegroundColor Yellow
    
    # –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç, –æ–±–µ—Ä–Ω—É—Ç—å –≤ –º–∞—Å—Å–∏–≤ –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
    if ($SelectedData -isnot [array]) {
        $SelectedData = @($SelectedData)
    }
    
    # –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    $allProperties = @()
    foreach ($item in $SelectedData) {
        if ($item -is [PSCustomObject]) {
            $properties = $item | Get-Member -MemberType Properties | Select-Object -ExpandProperty Name
            $allProperties = $allProperties + $properties | Sort-Object -Unique
        }
    }
    
    # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞, –ø–æ–∫–∞–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É
    if ($allProperties.Count -gt 0) {
        $SelectedData | Format-Table -Property $allProperties -AutoSize -Wrap
    }
    else {
        # –ï—Å–ª–∏ –Ω–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤, –ø–æ–∫–∞–∑–∞—Ç—å –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
        for ($i = 0; $i -lt $SelectedData.Count; $i++) {
            Write-Host "[$($i + 1)] $($SelectedData[$i])" -ForegroundColor White
        }
    }
    
    Write-Host "-------------------------" -ForegroundColor Yellow
    Write-Host "–í—ã–±—Ä–∞–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: $($SelectedData.Count)" -ForegroundColor Magenta
    Write-Host ""
}


# --- –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è ---
try { Get-Command gemini -ErrorAction Stop | Out-Null } catch { Write-Error "–ö–æ–º–∞–Ω–¥–∞ 'gemini' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞..."; return }
if (-not (Test-Path (Join-Path $scriptRoot ".gemini/GEMINI.md"))) { Write-Warning "–§–∞–π–ª —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ .gemini/GEMINI.md –Ω–µ –Ω–∞–π–¥–µ–Ω. –û—Ç–≤–µ—Ç—ã –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º–∏."; }
if (-not (Test-Path (Join-Path $scriptRoot ".gemini/ShowHelp.md"))) { Write-Warning "–§–∞–π–ª —Å–ø—Ä–∞–≤–∫–∏ .gemini/ShowHelp.md –Ω–µ –Ω–∞–π–¥–µ–Ω. –ö–æ–º–∞–Ω–¥–∞ '?' –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å."; }


# --- –®–∞–≥ 3: –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ ---
Write-Host "AI-–ø–æ–∏—Å–∫–æ–≤–∏–∫ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π. –ú–æ–¥–µ–ª—å: '$Model'." -ForegroundColor Green
Write-Host "–§–∞–π–ª —Å–µ—Å—Å–∏–∏ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤: $historyFilePath" -ForegroundColor Yellow
Write-Host "–í–≤–µ–¥–∏—Ç–µ 'exit' –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–ª–∏ '?' –¥–ª—è –ø–æ–º–æ—â–∏."
    
$selectionContextJson = $null 
    
while ($true) {
    if ($selectionContextJson) {
        Write-Host -NoNewline -ForegroundColor Green "ü§ñAI [–í—ã–±–æ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞] :) > "
    }
    else {
        Write-Host -NoNewline -ForegroundColor Green "ü§ñAI :) > "
    }
    $UserPrompt = Read-Host
        
    $commandResult = Command-Handler -Command $UserPrompt
    if ($commandResult -eq 'break') { break }
    if ($commandResult -eq 'continue') { continue }

    if ([string]::IsNullOrWhiteSpace($UserPrompt)) { continue }
    
    Write-Host "–ò–¥–µ—Ç –ø–æ–∏—Å–∫ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞..." -ForegroundColor Gray
        
    $historyContent = ""
    if (Test-Path $historyFilePath) { $historyContent = Get-Content -Path $historyFilePath -Raw -ErrorAction SilentlyContinue }
        
    $fullPrompt = @"
### –ò–°–¢–û–†–ò–Ø –î–ò–ê–õ–û–ì–ê (–ö–û–ù–¢–ï–ö–°–¢)
$historyContent
"@
        
    if ($selectionContextJson) {
        $selectionBlock = @"

### –î–ê–ù–ù–´–ï –ò–ó –í–´–ë–û–†–ö–ò (–î–õ–Ø –ê–ù–ê–õ–ò–ó–ê)
$selectionContextJson
"@
        $fullPrompt += $selectionBlock
        $selectionContextJson = $null 
    }

    $fullPrompt += @"

### –ù–û–í–ê–Ø –ó–ê–î–ê–ß–ê
$UserPrompt
"@

    $ModelResponse = Invoke-GeminiPrompt -Prompt $fullPrompt -Model $Model
        
    if ($ModelResponse) {
        $jsonToParse = $null
        $jsonPattern = '(?s)```json\s*(.*?)\s*```'
            
        if ($ModelResponse -match $jsonPattern) { $jsonToParse = $matches[1] }
        else { $jsonToParse = $ModelResponse }
            
        try {
            $jsonObject = $jsonToParse | ConvertFrom-Json
            Write-Host "`n--- Gemini (–æ–±—ä–µ–∫—Ç JSON) ---`n" -ForegroundColor Green
                
            $gridSelection = $jsonObject | Out-ConsoleGridView -Title "–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (OK) –∏–ª–∏ –∑–∞–∫—Ä–æ–π—Ç–µ (Cancel)" -OutputMode Multiple
                
            if ($null -ne $gridSelection) {
                # --- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ ---
                Show-SelectionTable -SelectedData $gridSelection
                # --- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø ---
                
                $selectionContextJson = $gridSelection | ConvertTo-Json -Compress -Depth 10
                Write-Host "–í—ã–±–æ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, '—Å—Ä–∞–≤–Ω–∏ –∏—Ö')." -ForegroundColor Magenta
            }
        }
        catch {
            Write-Host $ModelResponse -ForegroundColor Cyan
        }
            
        Add-History -UserPrompt $UserPrompt -ModelResponse $ModelResponse
    }
}

Write-Host "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã." -ForegroundColor Green
```

# –ê –¥–∞–≤–∞–π—Ç–µ –≤—Å—Ç—Ä–æ–∏–º –ò–ò –≤ PowerShell. –ß–∞—Å—Ç—å –≤—Ç–æ—Ä–∞—è. –ü–æ–∏—Å–∫–æ–≤–∏–∫ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)

## –° —á–µ–≥–æ –≤—Å–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è: API –∫–ª—é—á –∏ –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ –≤ –Ω–∞—à–µ–º —Å–∫—Ä–∏–ø—Ç–µ - —ç—Ç–æ –±–ª–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏. –ë–µ–∑ –Ω–µ–≥–æ –Ω–∏—á–µ–≥–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –±—É–¥–µ—Ç:

```powershell
# --- –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ---
$env:GEMINI_API_KEY = "AIzaSyCbq8bkt5Xr2hlE-73MIXFpdFYH-rLBd0k"
if (-not $env:GEMINI_API_KEY) { Write-Error "..."; return }

$scriptRoot = Get-Location
$HistoryDir = Join-Path $scriptRoot ".gemini/.chat_history"
$timestamp = Get-Date -Format "yyyy-MM-dd_HH-mm-ss"
$historyFileName = "ai_session_$timestamp.jsonl"
$historyFilePath = Join-Path $HistoryDir $historyFileName
```

**–ß—Ç–æ –∑–¥–µ—Å—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:**

1. **API –∫–ª—é—á Gemini** - –±–µ–∑ –Ω–µ–≥–æ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ—Å—Ç–æ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è. –≠—Ç–æ –≤–∞—à "–ø—Ä–æ–ø—É—Å–∫" –∫ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º AI.
2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫** - —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö.
3. **–£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Å–µ—Å—Å–∏–∏** - –∫–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –∏—Å—Ç–æ—Ä–∏–∏ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π.

**–ì–¥–µ –≤–∑—è—Ç—å API –∫–ª—é—á:** –ò–¥–∏—Ç–µ –Ω–∞ [Google AI Studio](https://makersuite.google.com/), —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á. –û–Ω –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è - —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ

–°–ª–µ–¥—É—é—â–∏–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –±–ª–æ–∫:

```powershell
# --- –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è ---
try { Get-Command gemini -ErrorAction Stop | Out-Null } 
catch { Write-Error "–ö–æ–º–∞–Ω–¥–∞ 'gemini' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞..."; return }
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:**

1. **Gemini CLI** - –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å AI. –°–∫–∞—á–∞–π—Ç–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞ Google.
2. **PowerShell 7+** - –¥–ª—è —Ä–∞–±–æ—Ç—ã `Out-ConsoleGridView`. –í Windows PowerShell 5.1 —ç—Ç–æ—Ç –∫–æ–º–∞–Ω–¥–ª–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:**
```powershell
# –ü—Ä–æ–≤–µ—Ä—è–µ–º Gemini CLI
gemini --version

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Out-ConsoleGridView 
Get-Command Out-ConsoleGridView
```

## –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –º–æ—Å—Ç –∫ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É

–°–µ—Ä–¥—Ü–µ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã - —Ñ—É–Ω–∫—Ü–∏—è `Invoke-GeminiPrompt`:

```powershell
function Invoke-GeminiPrompt {
    param([string]$Prompt, [string]$Model)
    try {
        # –í—ã–∑—ã–≤–∞–µ–º Gemini CLI –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ –≤—ã–≤–æ–¥—ã
        $output = & gemini -m $Model -p $Prompt 2>&1
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        if (-not $?) { 
            $output | ForEach-Object { Write-Warning $_.ToString() }
            return $null 
        }
        
        # –û—á–∏—â–∞–µ–º –≤—ã–≤–æ–¥ –æ—Ç —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        $outputString = ($output -join [Environment]::NewLine).Trim()
        $cleanedOutput = $outputString -replace "(?m)^Data collection is disabled\.`r?`n" , ""
        $cleanedOutput = $cleanedOutput -replace "(?m)^Loaded cached credentials\.`r?`n", ""
        
        return $cleanedOutput.Trim()
    }
    catch { 
        Write-Error "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ Gemini CLI: $_"
        return $null 
    }
}
```

**–ü–æ—á–µ–º—É —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ç–∞–∫ –≤–∞–∂–Ω–∞:**
- –û–Ω–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å CLI
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–µ—à–∞—é—Ç –ø–∞—Ä—Å–∏–Ω–≥—É JSON
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å—Ç—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≥–æ—Ç–æ–≤—ã–π –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

–°–∫—Ä–∏–ø—Ç –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —Ç—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫–µ `.gemini/`:

### `.gemini/GEMINI.md` - —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (—Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π!)

–≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –ö–ê–ö –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è AI. –ü—Ä–∏–º–µ—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:

```markdown
# –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∏—Å–∫–æ–≤–∏–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π

–¢—ã - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.

## –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã:
1. –í–°–ï–ì–î–ê –≤–æ–∑–≤—Ä–∞—â–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –º–∞—Å—Å–∏–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤
2. –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è:
   - "name": –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
   - "manufacturer": –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å
   - "category": –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞
   - "specifications": –æ–±—ä–µ–∫—Ç —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
   - "price_range": –ø—Ä–∏–º–µ—Ä–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω –≤ USD
   - "availability": —Å—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

3. –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –∏—Å–ø–æ–ª—å–∑—É–π –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
4. –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ—Ç–æ—á–Ω–∞—è, —É–∫–∞–∑—ã–≤–∞–π —ç—Ç–æ –≤ –ø–æ–ª–µ "notes"
5. –ü—Ä–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞–π—Ç–∏ –¥–∞–Ω–Ω—ã–µ, –≤–æ–∑–≤—Ä–∞—â–∞–π –æ–±—ä–µ–∫—Ç —Å –ø–æ–ª–µ–º "error" –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏ –ø–æ —É—Ç–æ—á–Ω–µ–Ω–∏—é –∑–∞–ø—Ä–æ—Å–∞

## –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
[
  {
    "name": "Intel Core i5-12400F",
    "manufacturer": "Intel",
    "category": "CPU",
    "specifications": {
      "cores": 6,
      "threads": 12,
      "base_clock": "2.5 GHz",
      "boost_clock": "4.4 GHz",
      "socket": "LGA1700"
    },
    "price_range": "$150-180",
    "availability": "–í –Ω–∞–ª–∏—á–∏–∏"
  }
]
```

**–ü–æ—á–µ–º—É —ç—Ç–æ—Ç —Ñ–∞–π–ª –∫—Ä–∏—Ç–∏—á–µ–Ω:** –ë–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ AI –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –∏ –ø–∞—Ä—Å–∏–Ω–≥ JSON –±—É–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ª–æ–º–∞—Ç—å—Å—è.

### `.gemini/ShowHelp.md` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```markdown
# AI-–ø–æ–∏—Å–∫–æ–≤–∏–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π

## –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:
–ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –º–æ–¥–µ–ª—å –∏–ª–∏ –∞—Ä—Ç–∏–∫—É–ª –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
- `Intel Core i7-13700K` - –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä Intel
- `Gigabyte B650 AORUS ELITE AX` - –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ø–ª–∞—Ç–∞  
- `RTX 4070 Ti Super` - –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞
- `Schneider Electric A9C21834` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å
- `Cisco WS-C2960-24TT-L` - —Å–µ—Ç–µ–≤–æ–π –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
- `?` - –ø–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É
- `history` - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
- `clear` - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–µ—Å—Å–∏–∏
- `gemini help` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ Gemini CLI
- `exit` –∏–ª–∏ `quit` - –≤—ã–π—Ç–∏ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã

### –†–∞–±–æ—Ç–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏:
1. –ü–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
2. –í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ (Ctrl+Click –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞)
3. –ù–∞–∂–º–∏—Ç–µ OK - –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∑—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏
4. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å: "—Å—Ä–∞–≤–Ω–∏ –∏—Ö", "–Ω–∞–π–¥–∏ –∞–Ω–∞–ª–æ–≥–∏", "–≥–¥–µ –∫—É–ø–∏—Ç—å –¥–µ—à–µ–≤–ª–µ"

### –°–æ–≤–µ—Ç—ã:
- –£–∫–∞–∑—ã–≤–∞–π—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –∞—Ä—Ç–∏–∫—É–ª
- –î–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é: "—Ä–µ–ª–µ –≤—Ä–µ–º–µ–Ω–∏ ABB"
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –∑–∞—Ä—É–±–µ–∂–Ω—ã—Ö –±—Ä–µ–Ω–¥–æ–≤
```

## –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –ø—Ä–æ–≥—Ä–∞–º–º—ã - –∫–∞–∫ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```powershell
while ($true) {
    # 1. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —Å –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è
    if ($selectionContextJson) {
        Write-Host -NoNewline -ForegroundColor Green "ü§ñAI [–í—ã–±–æ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞] :) > "
    } else {
        Write-Host -NoNewline -ForegroundColor Green "ü§ñAI :) > "
    }
    
    # 2. –ü–æ–ª—É—á–∞–µ–º –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    $UserPrompt = Read-Host
    
    # 3. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
    $commandResult = Command-Handler -Command $UserPrompt
    if ($commandResult -eq 'break') { break }
    if ($commandResult -eq 'continue') { continue }
    
    # 4. –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI
    $fullPrompt = "### –ò–°–¢–û–†–ò–Ø –î–ò–ê–õ–û–ì–ê\n$historyContent"
    if ($selectionContextJson) {
        $fullPrompt += "\n### –î–ê–ù–ù–´–ï –ò–ó –í–´–ë–û–†–ö–ò\n$selectionContextJson"
    }
    $fullPrompt += "\n### –ù–û–í–ê–Ø –ó–ê–î–ê–ß–ê\n$UserPrompt"
    
    # 5. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –≤ AI
    $ModelResponse = Invoke-GeminiPrompt -Prompt $fullPrompt -Model $Model
    
    # 6. –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∫–∞–∫ JSON –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É
    try {
        $jsonObject = $jsonToParse | ConvertFrom-Json
        $gridSelection = $jsonObject | Out-ConsoleGridView -Title "–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏..." -OutputMode Multiple
        
        if ($null -ne $gridSelection) {
            Show-SelectionTable -SelectedData $gridSelection
            $selectionContextJson = $gridSelection | ConvertTo-Json -Compress -Depth 10
        }
    }
    catch {
        # –ù–µ JSON - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
        Write-Host $ModelResponse -ForegroundColor Cyan
    }
    
    # 7. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
    Add-History -UserPrompt $UserPrompt -ModelResponse $ModelResponse
}
```

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:** –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –≤–∫–ª—é—á–∞–µ—Ç –≤—Å—é –ø—Ä–µ–¥—ã–¥—É—â—É—é –∏—Å—Ç–æ—Ä–∏—é + –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –¢–∞–∫ AI "–ø–æ–º–Ω–∏—Ç" –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞.

## –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π - –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

```powershell
function Add-History { 
    param([string]$UserPrompt, [string]$ModelResponse)
    if (-not (Test-Path $HistoryDir)) { New-Item -Path $HistoryDir -ItemType Directory | Out-Null }
    @{ user = $UserPrompt } | ConvertTo-Json -Compress | Add-Content -Path $historyFilePath
    @{ model = $ModelResponse } | ConvertTo-Json -Compress | Add-Content -Path $historyFilePath
}
```

**–ü–æ—á–µ–º—É –∏—Å—Ç–æ—Ä–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞:** AI-–º–æ–¥–µ–ª–∏ –Ω–µ –∏–º–µ—é—Ç –ø–∞–º—è—Ç–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏. –ú—ã —Å–æ–∑–¥–∞–µ–º "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å", –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é —Å –∫–∞–∂–¥—ã–º –Ω–æ–≤—ã–º –≤–æ–ø—Ä–æ—Å–æ–º.

### –ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```powershell
function Show-SelectionTable {
    param([array]$SelectedData)
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
    $allProperties = @()
    foreach ($item in $SelectedData) {
        if ($item -is [PSCustomObject]) {
            $properties = $item | Get-Member -MemberType Properties | Select-Object -ExpandProperty Name
            $allProperties = $allProperties + $properties | Sort-Object -Unique
        }
    }
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
    if ($allProperties.Count -gt 0) {
        $SelectedData | Format-Table -Property $allProperties -AutoSize -Wrap
    } else {
        for ($i = 0; $i -lt $SelectedData.Count; $i++) {
            Write-Host "[$($i + 1)] $($SelectedData[$i])" -ForegroundColor White
        }
    }
}
```

**–ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è:** –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤ `Out-ConsoleGridView` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤—ã–±—Ä–∞–ª. –§—É–Ω–∫—Ü–∏—è —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –ø–æ–∫–∞–∑—ã–≤–∞—è –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å–æ–ª–∏.

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. **–ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç:**
   ```powershell
   .\Find-Spec.ps1
   ```

2. **–ò—â–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:**
   ```
   ü§ñAI :) > RTX 4070 Ti Super
   ```

3. **–ü–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É, –≤—ã–±–∏—Ä–∞–µ–º –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –º–æ–¥–µ–ª–∏**

4. **–ó–∞–¥–∞–µ–º —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å:**
   ```
   ü§ñAI [–í—ã–±–æ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞] :) > —Å—Ä–∞–≤–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –∏–≥—Ä–∞—Ö
   ```

5. **–ü–æ–ª—É—á–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

–í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.