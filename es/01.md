# Filosof√≠a de PowerShell.
## Parte 0.
¬øQu√© hab√≠a antes de PowerShell?
En 1981, se lanz√≥ MS-DOS 1.0 con el int√©rprete de comandos `COMMAND.COM`. Para la automatizaci√≥n de tareas se utilizaban **archivos por lotes (`.bat`)** ‚Äîsimples archivos de texto con una secuencia de comandos de consola. El sorprendente ascetismo de la l√≠nea de comandos en contraste con los sistemas compatibles con POSIX donde ya desde 1979 exist√≠a la **shell de Bourne (`sh`)**. 



### üìÖ Estado del mercado de shells en el momento del lanzamiento de **MS-DOS 1.0** (agosto de 1981)

Aqu√≠ hay una tabla resumida de los sistemas operativos populares de la √©poca y su soporte de shells (`sh`, `csh`, etc.):

| Sistema Operativo            | Soporte de Shell (`sh`, `csh`, etc.) | Comentario                                                  |
| ---------------------------- | ------------------------------------ | ------------------------------------------------------------ |
| **UNIX Versi√≥n 7 (V7)**      | `sh`                                 | √öltimo UNIX cl√°sico de Bell Labs, ampliamente distribuido    |
| **UNIX/32V**                 | `sh`, `csh`                          | Versi√≥n de UNIX para la arquitectura VAX                     |
| **4BSD / 3BSD**              | `sh`, `csh`                          | Rama universitaria de UNIX de Berkeley                       |
| **UNIX System III**          | `sh`                                 | Primera versi√≥n comercial de AT&T, predecesora de System V   |
| **Xenix (de Microsoft)**     | `sh`                                 | Versi√≥n de UNIX con licencia, vendida por Microsoft desde 1980 |
| **IDRIS**                    | `sh`                                 | SO similar a UNIX para PDP-11 e Intel                        |
| **Coherent (Mark Williams)** | `sh` (similar)                       | Alternativa econ√≥mica a UNIX para PC                         |
| **CP/M (Digital Research)**  | ‚ùå (No `sh`, solo CLI m√°s simple)    | No es UNIX, el SO m√°s popular para PC de 8 bits              |
| **MS-DOS 1.0**               | ‚ùå (solo `COMMAND.COM`)               | Shell de comandos m√≠nima, sin scripts ni pipes               |

---

### üí° ¬øQu√© son `sh`, `csh`

* `sh` ‚Äî **Bourne Shell**, el int√©rprete de scripting principal de UNIX desde 1977.
* `csh` ‚Äî **C Shell**, una shell mejorada con sintaxis similar a C y comodidades para el trabajo interactivo.
* Estas shells **soportaban redirecciones, pipes, variables, funciones y condicionales** ‚Äî todo lo que hizo de UNIX una poderosa herramienta de automatizaci√≥n.

---

Microsoft se centr√≥ en **PC IBM de 16 bits baratos**, que ten√≠an **poca memoria** (generalmente 64‚Äì256 KB), carec√≠an de multitarea y estaban destinados al **uso dom√©stico y de oficina**, no a servidores. UNIX era caro, requer√≠a una arquitectura compleja y experiencia, mientras que los contables e ingenieros, no los administradores de sistemas, necesitaban un sistema operativo r√°pido y sencillo.

La interfaz de DOS, en lugar del complejo `sh`, presentaba un solo archivo command.com con un escaso conjunto de comandos internos [ (dir, copy, del, etc.)](https://www.techgeekbuzz.com/blog/dos-commands/){:target="_blank"} sin funciones, bucles o m√≥dulos.

Tambi√©n hab√≠a comandos externos ‚Äîarchivos ejecutables separados (.exe o .com). Ejemplos: FORMAT.COM, XCOPY.EXE, CHKDSK.EXE, EDIT.COM.
Los scripts de ejecuci√≥n se escrib√≠an en un archivo de texto con la extensi√≥n .bat (archivo por lotes).

Ejemplos de archivos de configuraci√≥n:

- AUTOEXEC.BAT

```bash
:: ------------------------------------------------------------------------------
:: AUTOEXEC.BAT ‚Äî Configuraci√≥n autom√°tica e inicio de Windows 3.11
:: Autor: hypo69
:: A√±o: aproximadamente 1993
:: Prop√≥sito: Realiza la inicializaci√≥n del entorno DOS, carga los controladores de red e inicia Windows 3.11
:: ------------------------------------------------------------------------------
@ECHO OFF

:: Configuraci√≥n del prompt de comandos
PROMPT $p$g

:: Configuraci√≥n de variables de entorno
SET TEMP=C:\TEMP
PATH=C:\DOS;C:\WINDOWS

:: Carga de controladores y utilidades en la memoria superior
LH C:\DOS\SMARTDRV.EXE       :: Cach√© de disco
LH C:\DOS\MOUSE.COM          :: Controlador de rat√≥n

:: Carga de servicios de red (relevante para Windows for Workgroups 3.11)
IF EXIST C:\NET\NET.EXE LH C:\NET\NET START

:: Inicio autom√°tico de Windows
WIN

```
- CONFIG.SYS
```bash
:: ------------------------------------------------------------------------------
:: CONFIG.SYS ‚Äî Configuraci√≥n de memoria y controladores de DOS para Windows 3.11
:: Autor: hypo69
:: A√±o: aproximadamente 1993
:: Prop√≥sito: Inicializa los controladores de memoria, configura los par√°metros del sistema
:: ------------------------------------------------------------------------------
DEVICE=C:\DOS\HIMEM.SYS
DEVICE=C:\DOS\EMM386.EXE NOEMS
DOS=HIGH,UMB
FILES=40
BUFFERS=30
DEVICEHIGH=C:\DOS\SETVER.EXE

```

En Microsoft, paralelamente a DOS, casi de inmediato se comenz√≥ a desarrollar un n√∫cleo fundamentalmente nuevo.

El n√∫cleo [**Windows NT**](https://www.wikiwand.com/ru/articles/Windows_NT){:target="_blank"} (New Technology) apareci√≥ por primera vez con el lanzamiento del sistema operativo:

> **Windows NT 3.1 ‚Äî 27 de julio de 1993**

---

* **El desarrollo comenz√≥**: en **1988** bajo el liderazgo de **Dave Cutler** (ex ingeniero de DEC, creador de VMS) con el objetivo de crear un sistema operativo completamente nuevo, seguro, port√°til y multitarea, no compatible con MS-DOS a nivel de n√∫cleo.
* **NT 3.1** ‚Äî se llam√≥ as√≠ para enfatizar la compatibilidad con **Windows 3.1** a nivel de interfaz, pero ten√≠a una **arquitectura completamente nueva**.

---

#### üß† Lo que trajo el n√∫cleo NT:

| Caracter√≠stica                     | Descripci√≥n                                                           |
| ---------------------------------- | --------------------------------------------------------------------- |
| **Arquitectura de 32 bits**        | A diferencia de MS-DOS y Windows 3.x, que eran de 16 bits.            |
| **Multitarea**                     | Multitarea preferente real.                                           |
| **Memoria protegida**              | Los programas no pod√≠an corromper la memoria de otros.                |
| **Modularidad**                    | Arquitectura de n√∫cleo de m√∫ltiples capas: HAL, Executive, Kernel, controladores. |
| **Soporte multiplataforma**        | NT 3.1 funcionaba en x86, MIPS y Alpha.                               |
| **Compatibilidad con POSIX**       | NT se entregaba con un **subsistema POSIX**, certificado para POSIX.1. |

---

#### üìú L√≠nea de tiempo de NT:

| Versi√≥n NT    | A√±o       | Comentario                          |
| ------------- | --------- | ----------------------------------- |
| NT 3.1        | 1993      | Primer lanzamiento de NT            |
| NT 3.5 / 3.51 | 1994‚Äì1995 | Mejoras, optimizaci√≥n               |
| NT 4.0        | 1996      | Interfaz de Windows 95, pero n√∫cleo NT |
| Windows 2000  | 2000      | NT 5.0                              |
| Windows XP    | 2001      | NT 5.1                              |
| Windows Vista | 2007      | NT 6.0                              |
| Windows 10    | 2015      | NT 10.0                             |
| Windows 11    | 2021      | Tambi√©n NT 10.0 (marketing üòä)       |

---

Diferencia en las capacidades del sistema operativo:

| Caracter√≠stica                  | **MS-DOS** (1981)                       | **Windows NT** (1993)                               |
| ------------------------------- | --------------------------------------- | --------------------------------------------------- |
| **Tipo de sistema**             | Monol√≠tico, monotarea                   | Micron√∫cleo/h√≠brido, multitarea                     |
| **Bits**                        | 16 bits                                 | 32 bits (con soporte de 64 bits desde NT 5.2 / XP x64) |
| **Multitarea**                  | ‚ùå Ausente (un proceso a la vez)        | ‚úÖ Multitarea preferente                            |
| **Memoria protegida**           | ‚ùå No                                   | ‚úÖ S√≠ (cada proceso en su propio espacio de direcciones) |
| **Modo multiusuario**           | ‚ùå No                                   | ‚úÖ Parcialmente (en NT Workstation/Server)          |
| **Compatibilidad con POSIX**    | ‚ùå No                                   | ‚úÖ Subsistema POSIX integrado en NT 3.1‚Äì5.2         |
| **Portabilidad del n√∫cleo**     | ‚ùå Solo x86                             | ‚úÖ x86, MIPS, Alpha, PowerPC                        |
| **Controladores**               | Acceso directo al hardware              | A trav√©s de HAL y controladores en modo kernel      |
| **Nivel de acceso de aplicaciones** | Aplicaciones = nivel de sistema        | Nivel de usuario / n√∫cleo separados                 |
| **Seguridad**                   | ‚ùå Ausente                              | ‚úÖ Modelo de seguridad: SID, ACL, tokens de acceso  |
| **Estabilidad**                 | ‚ùå Dependencia de un programa = ca√≠da del SO | ‚úÖ Aislamiento de procesos, protecci√≥n del n√∫cleo   |

---

¬°Pero hab√≠a un gran PERO! A las herramientas de automatizaci√≥n y administraci√≥n no se les prest√≥ la debida atenci√≥n hasta 2002.

---

Microsoft utiliz√≥ enfoques, estrategias y herramientas completamente diferentes para la administraci√≥n. Todo esto estaba **desarticulado**, a menudo orientado a la GUI y no siempre automatizable.

---

##### üìå Lista de algunas herramientas:

| Herramienta                   | Prop√≥sito                                                       |
| ----------------------------- | --------------------------------------------------------------- |
| `cmd.exe`                     | Int√©rprete de comandos mejorado (reemplazo de `COMMAND.COM`)    |
| `.bat`, `.cmd`                | Scripts de l√≠nea de comandos                                    |
| **Windows Script Host (WSH)** | Soporte para VBScript y JScript para automatizaci√≥n             |
| `reg.exe`                     | Gesti√≥n del registro desde la l√≠nea de comandos                 |
| `net.exe`                     | Trabajar con usuarios, red, impresoras                          |
| `sc.exe`                      | Gesti√≥n de servicios                                            |
| `tasklist`, `taskkill`        | Gesti√≥n de procesos                                             |
| `gpedit.msc`                  | Pol√≠tica de grupo (local)                                       |
| `MMC`                         | Consola con complementos para la gesti√≥n                        |
| `WMI`                         | Acceso a la informaci√≥n del sistema (a trav√©s de `wmic`, VBScript o COM) |
| `WbemTest.exe`                | GUI para probar consultas WMI                                   |
| `eventvwr`                    | Visor de registros de eventos                                   |
| `perfmon`                     | Monitoreo de recursos                                           |

##### üõ† Ejemplos de automatizaci√≥n:

* Archivos VBScript (`*.vbs`) para administrar usuarios, redes, impresoras y servicios.
* `WMIC` ‚Äî interfaz de l√≠nea de comandos para WMI (por ejemplo: `wmic process list brief`).
* Scripts `.cmd` con llamadas a `net`, `sc`, `reg`, `wmic`, etc.

---

### ‚öôÔ∏è Windows Scripting Host (WSH)

* Apareci√≥ por primera vez en **Windows 98**, utilizado activamente en **Windows 2000 y XP**.
* Permit√≠a ejecutar archivos VBScript y JScript desde la l√≠nea de comandos:

  ```vbscript
  Set objShell = WScript.CreateObject("WScript.Shell")
  objShell.Run "notepad.exe"
  ```

---
## Parte 1.

Solo en 2002 la compa√±√≠a formul√≥ el proyecto <a href="https://learn.microsoft.com/en-us/powershell/scripting/developer/monad-manifesto?view=powershell-7.5" target="_blank">Monad</a>, que m√°s tarde evolucion√≥ a PowerShell:

Inicio del desarrollo: aproximadamente en 2002

Anuncio p√∫blico: 2003, como "Monad Shell"

Primeras versiones beta: aparecieron en 2005

Lanzamiento final (PowerShell 1.0): noviembre de 2006

El autor y arquitecto principal del proyecto Monad / PowerShell es Jeffrey Snover
<a href="https://www.wikiwand.com/en/articles/Jeffrey_Snover" target="_blank"> (Jeffrey Snover)</a>

Hoy PowerShell Core se ejecuta en
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/windows-core.md" target="_blank">Windows</a>
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/macos.md" target="_blank">macOS</a>
<a href="https://github.com/PowerShell/PowerShell/blob/master/docs/building/linux.md" target="_blank">Linux</a>

Paralelamente, se estaba desarrollando el framework .NET y PowerShell se integr√≥ profundamente en √©l; en los siguientes cap√≠tulos mostrar√© ejemplos.

¬°Y ahora ‚Äî lo m√°s importante!

La principal ventaja de PowerShell en comparaci√≥n con las shells de comandos cl√°sicas es que trabaja con *objetos*, no con texto. Cuando se ejecuta un comando, no devuelve solo texto, sino un objeto estructurado (o una colecci√≥n de objetos) que tiene propiedades y m√©todos claramente definidos.

Vea c√≥mo PowerShell supera a las shells cl√°sicas gracias al **trabajo con objetos**.

### üìÅ C√≥mo era: `dir` y an√°lisis manual

En **CMD** (tanto en el antiguo `COMMAND.COM` como en `cmd.exe`), el comando `dir` devuelve el resultado como texto plano. Ejemplo de salida:

```
24.07.2025  21:15         1 428  my_script.js
25.07.2025  08:01         3 980  report.html
```

Supongamos que desea extraer el **nombre de archivo** y el **tama√±o** de cada archivo. Tendr√° que analizar las l√≠neas manualmente:
```cmd
for /f "tokens=5,6" %a in ('dir ^| findstr /R "[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]"') do @echo %a %b
```

* Esto es terriblemente dif√≠cil de leer, depende de la configuraci√≥n regional, el formato de fecha, la fuente. Y se rompe con espacios en los nombres.

---

### ‚úÖ PowerShell: objetos en lugar de texto

#### ‚úî Ejemplo simple y legible:

```powershell
Get-ChildItem | Select-Object Name, Length
```

**Resultado:**

```
Name          Length
----          ------
my_script.js   1428
report.html    3980
```

* `Get-ChildItem` devuelve una **matriz de objetos de archivo/carpeta**
* `Select-Object` le permite obtener f√°cilmente las **propiedades** necesarias

---

### üîç ¬øQu√© devuelve realmente `Get-ChildItem`?

```powershell
$item = Get-ChildItem -Path .\my_script.js
$item | Get-Member
```

**Resultado:**

```
TypeName: System.IO.FileInfo

Name         MemberType     Definition
----         ---------      ----------
Length       Property       long Length {get;}
Name         Property       string Name {get;}
CreationTime Property       datetime CreationTime {get;set;}
Delete       Method         void Delete()
...
```

PowerShell devuelve **objetos de tipo `System.IO.FileInfo`**, que tienen:

* üß± Propiedades (`Name`, `Length`, `CreationTime`, `Extension`, ‚Ä¶)
* üõ† M√©todos (`Delete()`, `CopyTo()`, `MoveTo()` etc.)

Trabaja **con objetos completos**, no con cadenas.

---

### Sintaxis "Verbo-Sustantivo":

PowerShell utiliza una **sintaxis de comandos estricta y l√≥gica**:
`Verbo-Sustantivo`

| Verbo     | Qu√© hace     |
| --------- | ------------ |
| `Get-`    | Obtener      |
| `Set-`    | Establecer   |
| `New-`    | Crear        |
| `Remove-` | Eliminar     |
| `Start-`  | Iniciar      |
| `Stop-`   | Detener      |

| Sustantivo    | Sobre qu√© trabaja |
| ------------- | ----------------- |
| `Process`     | Proceso           |
| `Service`     | Servicio          |
| `Item`        | Archivo/carpeta   |
| `EventLog`    | Registros de eventos |
| `Computer`    | Computadora       |

#### üîÑ Ejemplos:

| Qu√© se debe hacer         | Comando         |
| ------------------------- | --------------- |
| Obtener procesos          | `Get-Process`   |
| Detener servicio          | `Stop-Service`  |
| Crear nuevo archivo       | `New-Item`      |
| Obtener contenido de carpeta | `Get-ChildItem` |
| Eliminar archivo          | `Remove-Item`   |

‚û° Incluso si **no conoce el comando exacto**, puede **adivinarlo** por su significado ‚Äî y casi siempre acertar√°.


---

El cmdlet `Get-Help` es su principal asistente.


1.  **Obtener ayuda sobre la propia ayuda:**
    ```powershell
    Get-Help Get-Help
    ```
2.  **Obtener ayuda b√°sica sobre el comando para trabajar con procesos:**
    ```powershell
    Get-Help Get-Process
    ```
3.  **Ver ejemplos de uso de este comando:**
    ```powershell
    Get-Help Get-Process -Examples
    ```
    Este es un par√°metro incre√≠blemente √∫til que a menudo proporciona soluciones listas para sus tareas.
4.  **Obtener la informaci√≥n m√°s detallada sobre el comando:**
    ```powershell
    Get-Help Get-Process -Full
    ```
En la siguiente parte: pipeline o cadena de comandos (PipeLines)